# Timeline Comparison - æœ€ç»ˆè®¾è®¡æ–¹æ¡ˆ

## ğŸ¯ ç»Ÿä¸€ä¾‹å­ï¼šThe Cat Example

**Prompt**: "The cat sat on"  
**Expected completion**: "the mat."

æ‰€æœ‰ä¸‰ç§æ–¹æ³•éƒ½ç”¨è¿™ä¸ªä¾‹å­ï¼Œæ¸…æ¥šå¯¹æ¯”æ•ˆç‡å·®å¼‚ã€‚

---

## ğŸ“ æ•´ä½“å¸ƒå±€

**æ¨ªå‘å¸ƒå±€**ï¼Œä¸‰è¡Œå¯¹æ¯”ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ (a) Autoregressive Decoding                                 â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ (b) Linear Speculative Decoding                             â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ (c) DynaTree (Tree-based Speculative Decoding)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

æ¯ä¸€è¡Œéƒ½å±•ç¤º**å®Œæ•´çš„ç”Ÿæˆè¿‡ç¨‹**ï¼Œä»promptåˆ°å®Œæˆã€‚

### ğŸ’¡ é‡è¦è¯´æ˜ï¼šå…³äºè¾“å…¥

**æ¯æ¬¡çš„è¾“å…¥éƒ½æ˜¯ç´¯ç§¯çš„å®Œæ•´context**ï¼š
- **Autoregressive**: æ¯æ­¥çš„è¾“å…¥ = prompt + æ‰€æœ‰å·²ç”Ÿæˆçš„tokens
  - Step 1: "The cat sat on" â†’ "the"
  - Step 2: "The cat sat on the" â†’ "mat"  
  - Step 3: "The cat sat on the mat" â†’ "."

- **Linear Speculative**: Draftå’ŒLLMéƒ½ä½¿ç”¨å®Œæ•´context
  - Iteration 1: Input = "The cat sat on"
    - Draftç”Ÿæˆ: [the, hat, ., ...] ä½†"hat"è¢«æ‹’ç»
    - åªæ¥å—: [the]ï¼Œåç»­çš„"., ..."éƒ½æµªè´¹äº†ï¼
  - Iteration 2: Input = "The cat sat on the"
    - Draftç”Ÿæˆ: [mat, .]ï¼Œéƒ½è¢«æ¥å—

- **DynaTree**: ä¸€æ¬¡æ€§ä½¿ç”¨å®Œæ•´context
  - Single iteration: Input = "The cat sat on"
    - Draft Treeæ¢ç´¢å¤šæ¡è·¯å¾„ï¼štheâ†’mat, theâ†’hat, theâ†’a, ...
    - LLMéªŒè¯åï¼Œé€‰æ‹©æœ€é•¿æœ‰æ•ˆè·¯å¾„ï¼štheâ†’matâ†’.
    - **å³ä½¿"hat"é”™äº†ï¼Œ"mat"è·¯å¾„ä»ç„¶æœ‰æ•ˆï¼**

è¿™å°±æ˜¯ä¸ºä»€ä¹ˆï¼š
- **ARæ…¢**: æ¯ä¸ªæ–°tokenéƒ½è¦é‡æ–°å¤„ç†æ•´ä¸ªcontextï¼ˆ3æ¬¡ï¼‰
- **Linearä¸­ç­‰**: Draftå‡ºé”™ä¼šæµªè´¹åç»­tokensï¼ˆ2æ¬¡ï¼‰
- **DynaTreeå¿«**: å¹¶è¡Œæ¢ç´¢ï¼Œä¸€æ¬¡å®Œæˆï¼ˆ1æ¬¡ï¼‰

---

## ğŸ”µ (a) Autoregressive Decoding

### è®¾è®¡æ€è·¯

ä¸²è¡Œç”Ÿæˆï¼Œæ¯æ¬¡1ä¸ªtokenï¼Œéœ€è¦3æ­¥å®Œæˆ"the mat."

### è§†è§‰å‘ˆç°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ (a) Autoregressive Decoding                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  Initial: "The cat sat on"                                          â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚   Step 1    â”‚ â†’  â”‚   Step 2    â”‚ â†’  â”‚   Step 3    â”‚            â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚
â”‚  â”‚ Input:      â”‚    â”‚ Input:      â”‚    â”‚ Input:      â”‚            â”‚
â”‚  â”‚ "The cat    â”‚    â”‚ "The cat    â”‚    â”‚ "The cat    â”‚            â”‚
â”‚  â”‚  sat on"    â”‚    â”‚  sat on the"â”‚    â”‚  sat on the â”‚            â”‚
â”‚  â”‚             â”‚    â”‚             â”‚    â”‚  mat"       â”‚            â”‚
â”‚  â”‚    LLM      â”‚    â”‚    LLM      â”‚    â”‚    LLM      â”‚            â”‚
â”‚  â”‚     â†“       â”‚    â”‚     â†“       â”‚    â”‚     â†“       â”‚            â”‚
â”‚  â”‚ Output: the â”‚    â”‚ Output: mat â”‚    â”‚ Output: .   â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                     â”‚
â”‚  Final: "The cat sat on the mat."                                  â”‚
â”‚                                                                     â”‚
â”‚  â±ï¸  Total: 3 iterations, 3 LLM calls, 3 tokens generated          â”‚
â”‚  ğŸ’¡ Note: Each step uses full context (prompt + all generated tokens)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®ç‚¹**ï¼š
- 3ä¸ªè“è‰²æ¡†ï¼Œæ¯ä¸ªä»£è¡¨ä¸€æ¬¡LLMè°ƒç”¨
- æ¯ä¸ªæ¡†å†…æ˜ç¡®æ ‡æ³¨Inputå’ŒOutput
- ç”¨ç®­å¤´â†’è¿æ¥ï¼Œè¡¨ç¤ºä¸²è¡Œ
- æœ€ä¸‹æ–¹æ€»ç»“ï¼š3 iterations

---

## ğŸŸ¢ (b) Linear Speculative Decoding

### è®¾è®¡æ€è·¯

ä¸¤é˜¶æ®µï¼šDraftç”Ÿæˆå¤šä¸ªå€™é€‰ï¼ŒLLMéªŒè¯ã€‚å‡è®¾Draftç”Ÿæˆ5ä¸ªï¼ŒLLMæ¥å—2ä¸ªï¼Œéœ€è¦2æ­¥å®Œæˆã€‚

### è§†è§‰å‘ˆç°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ (b) Linear Speculative Decoding                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  Initial: "The cat sat on"                                          â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚      Iteration 1             â”‚    â”‚      Iteration 2         â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚                              â”‚    â”‚                          â”‚  â”‚
â”‚  â”‚ 1) Draft Model:              â”‚    â”‚ 1) Draft Model:          â”‚  â”‚
â”‚  â”‚    Input: "The cat sat on"   â”‚    â”‚    Input: "The cat sat   â”‚  â”‚
â”‚  â”‚    Generates (sequentially): â”‚    â”‚           on the"        â”‚  â”‚
â”‚  â”‚    [the, hat, ., and, ...]   â”‚    â”‚    Generates:            â”‚  â”‚
â”‚  â”‚         â†“                    â”‚    â”‚    [mat, ., ...]         â”‚  â”‚
â”‚  â”‚ 2) LLM Verification:         â”‚    â”‚         â†“                â”‚  â”‚
â”‚  â”‚    Input: "The cat sat on"   â”‚    â”‚ 2) LLM Verification:     â”‚  â”‚
â”‚  â”‚    Verifies in parallel:     â”‚    â”‚    Input: "...sat on the"â”‚  â”‚
â”‚  â”‚    the âœ“  hat âœ—  (stop)      â”‚    â”‚    Verifies:             â”‚  â”‚
â”‚  â”‚         â†“                    â”‚    â”‚    mat âœ“  . âœ“            â”‚  â”‚
â”‚  â”‚ 3) Accept: [the] only        â”‚    â”‚         â†“                â”‚  â”‚
â”‚  â”‚    (hat rejected, rest       â”‚    â”‚ 3) Accept: [mat, .]      â”‚  â”‚
â”‚  â”‚     discarded)               â”‚    â”‚                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                                      â”‚                    â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º New context â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                                                     â”‚
â”‚  Final: "The cat sat on the mat."                                  â”‚
â”‚                                                                     â”‚
â”‚  â±ï¸  Total: 2 iterations, 2 Draft calls + 2 LLM calls, 3 tokens    â”‚
â”‚  ğŸ’¡ Note: Early rejection wastes subsequent draft tokens!          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®ç‚¹**ï¼š
- 2ä¸ªå¤§æ¡†ï¼ˆç»¿è‰²ï¼‰ï¼Œæ¯ä¸ªæ˜¯ä¸€è½®è¿­ä»£
- æ¯è½®åˆ†3æ­¥ï¼šDraft â†’ Verify â†’ Accept
- **Iteration 1**: Draftç”Ÿæˆ[the, hat, ...]ï¼Œä½†LLMå‘ç°"hat"é”™è¯¯ï¼ˆåº”è¯¥æ˜¯"mat"ï¼‰ï¼Œåªæ¥å—"the"
- **Iteration 2**: Draftç”Ÿæˆ[mat, .]ï¼ŒLLMéƒ½æ¥å—
- Verifiedç»“æœç”¨âœ“âœ—æ ‡æ³¨
- **å…³é”®é—®é¢˜**: ç¬¬ä¸€è½®Draftçš„"hat, ., and, ..."éƒ½è¢«æµªè´¹äº†ï¼
- æœ€ä¸‹æ–¹æ€»ç»“ï¼š2 iterations

**è¿™å°±æ˜¯Linearçš„ç¼ºé™·**: æ—©æœŸtokenè¢«æ‹’ç»æ—¶ï¼Œåç»­çš„æ‰€æœ‰draftéƒ½æµªè´¹äº†ï¼

---

## ğŸŸ£ (c) DynaTree (Tree-based Speculative Decoding)

### è®¾è®¡æ€è·¯

ä¸€æ¬¡æ€§ï¼šDraftç”Ÿæˆæ ‘ï¼ŒLLMéªŒè¯æ•´æ£µæ ‘ï¼Œæ¥å—æœ€é•¿è·¯å¾„ã€‚å‡è®¾ä¸€æ¬¡å°±å®Œæˆæ‰€æœ‰3ä¸ªtokenã€‚

### è§†è§‰å‘ˆç°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ (c) DynaTree (Tree-based Speculative Decoding)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  Initial: "The cat sat on"                                          â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    Single Iteration                            â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                                â”‚ â”‚
â”‚  â”‚  1) Draft Model generates tree:                               â”‚ â”‚
â”‚  â”‚                                                                â”‚ â”‚
â”‚  â”‚            Input: "The cat sat on"                             â”‚ â”‚
â”‚  â”‚                                                                â”‚ â”‚
â”‚  â”‚              â”Œâ”€â”€â”€ the â”€â”€â”€â”€â”                  Level 1           â”‚ â”‚
â”‚  â”‚             /       |      \                                   â”‚ â”‚
â”‚  â”‚           mat      hat      a                Level 2           â”‚ â”‚
â”‚  â”‚          / | \     / \     / \                                 â”‚ â”‚
â”‚  â”‚         .  ,  !   .  ,   mat  the            Level 3           â”‚ â”‚
â”‚  â”‚                                                                â”‚ â”‚
â”‚  â”‚     (Multiple paths explored, ~20-30 nodes total)             â”‚ â”‚
â”‚  â”‚                      â†“                                         â”‚ â”‚
â”‚  â”‚  2) LLM TreeVerify (single forward pass):                       â”‚ â”‚
â”‚  â”‚     Input: "The cat sat on"                                    â”‚ â”‚
â”‚  â”‚     LLM predicts for each node position:                       â”‚ â”‚
â”‚  â”‚       Position 1: LLM predicts "the" â†’ Draft has "the" â†’ âœ“    â”‚ â”‚
â”‚  â”‚       Position 2: LLM predicts "mat" â†’ Draft has "mat" â†’ âœ“    â”‚ â”‚
â”‚  â”‚                                        Draft has "hat" â†’ âœ—    â”‚ â”‚
â”‚  â”‚                                        Draft has "a"   â†’ âœ—    â”‚ â”‚
â”‚  â”‚       Position 3: LLM predicts "."   â†’ Draft has "."   â†’ âœ“    â”‚ â”‚
â”‚  â”‚                      â†“                                         â”‚ â”‚
â”‚  â”‚  3) Find longest matching path:                                â”‚ â”‚
â”‚  â”‚     Compare Draft tokens vs LLM predictions:                   â”‚ â”‚
â”‚  â”‚     - the â†’ mat â†’ . âœ“âœ“âœ“ (all match LLM predictions!)          â”‚ â”‚
â”‚  â”‚     - the â†’ hat â†’ . âœ—âœ—âœ— ("hat" â‰  LLM's "mat")                 â”‚ â”‚
â”‚  â”‚     - the â†’ a â†’ ...  âœ—âœ— ("a" â‰  LLM's "mat")                   â”‚ â”‚
â”‚  â”‚                                                                â”‚ â”‚
â”‚  â”‚     Accept: [the, mat, .]  (3 tokens, longest valid path)     â”‚ â”‚
â”‚  â”‚                                                                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚  Final: "The cat sat on the mat."                                  â”‚
â”‚                                                                     â”‚
â”‚  â±ï¸  Total: 1 iteration, 1 Draft call + 1 LLM call, 3 tokens       â”‚
â”‚  ğŸ’¡ Note: Tree verification checks all paths simultaneously        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®ç‚¹**ï¼š
- 1ä¸ªå¤§æ¡†ï¼ˆç´«è‰²ï¼‰ï¼Œåªéœ€ä¸€è½®è¿­ä»£
- Draftæ¢ç´¢äº†å¤šä¸ªåˆ†æ”¯ï¼štheâ†’mat, theâ†’hat, theâ†’a
- LLMä¸€æ¬¡æ€§éªŒè¯æ‰€æœ‰è·¯å¾„
- æ‰¾åˆ°æœ€é•¿çš„æœ‰æ•ˆè·¯å¾„ï¼štheâ†’matâ†’. âœ“âœ“âœ“
- **Treeçš„ä¼˜åŠ¿**: å³ä½¿"hat"åˆ†æ”¯é”™äº†ï¼Œ"mat"åˆ†æ”¯ä»ç„¶å¯ç”¨ï¼Œä¸€æ¬¡å°±å®Œæˆï¼
- å¯¹æ¯”Linearï¼šLinearç¬¬ä¸€è½®åªèƒ½æ¢ç´¢ä¸€æ¡è·¯å¾„[the, hat, ...]ï¼Œhaté”™äº†å°±å¾—é‡æ¥
- æœ€ä¸‹æ–¹æ€»ç»“ï¼š1 iterationï¼ˆå…³é”®ï¼ï¼‰

**è¿™å°±æ˜¯Treeçš„ä¼˜åŠ¿**: å¹¶è¡Œæ¢ç´¢å¤šä¸ªåˆ†æ”¯ï¼Œæ‰¾åˆ°æœ€é•¿çš„æ­£ç¡®è·¯å¾„ï¼

---

## ğŸ¨ å…·ä½“ç»˜åˆ¶æŒ‡å—

### é…è‰²æ–¹æ¡ˆ

| æ–¹æ³• | ä¸»è‰² | ç”¨é€” |
|------|------|------|
| AR | è“è‰² (#2196F3) | æ¡†çš„è¾¹æ¡† |
| Linear | ç»¿è‰² (#4CAF50) | Draftæ¡†è¾¹æ¡†ï¼Œæ©™è‰² (#FF9800) Verifyæ¡† |
| DynaTree | ç´«è‰² (#9C27B0) | Draftæ¡†ï¼Œçº¢è‰² (#F44336) Verifyæ¡† |
| Accepted | æ·±ç»¿ (#2E7D32) | âœ“ æ ‡è®°å’Œaccepted tokens |
| Rejected | ç°è‰² (#9E9E9E) | âœ— æ ‡è®°å’Œrejected candidates |
| Context | æµ…ç° (#F5F5F5) | èƒŒæ™¯è‰² |

### å°ºå¯¸å»ºè®®

**ç”»å¸ƒ**ï¼š
- å®½åº¦ï¼š1400px
- é«˜åº¦ï¼š1000pxï¼ˆæ¯ä¸ªæ–¹æ³•çº¦300pxï¼‰

**æ¡†çš„å¤§å°**ï¼š
- ARï¼š3ä¸ªå°æ¡†ï¼Œæ¯ä¸ª 200Ã—150px
- Linearï¼š2ä¸ªå¤§æ¡†ï¼Œæ¯ä¸ª 350Ã—200px
- DynaTreeï¼š1ä¸ªå¤§æ¡†ï¼Œ600Ã—250px

### å…³é”®è§†è§‰å…ƒç´ 

#### 1. **Input/Outputæ ‡æ³¨**

æ¯ä¸ªæ¡†å†…éƒ½è¦æœ‰ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Input:       â”‚ â† å°å­—ï¼Œç°è‰²
â”‚ "...sat on"  â”‚
â”‚              â”‚
â”‚    [LLM]     â”‚ â† å¤§å­—ï¼Œç²—ä½“
â”‚      â†“       â”‚
â”‚ Output: the  â”‚ â† å°å­—ï¼Œç»¿è‰²
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2. **æ ‘çš„å±•ç¤º**ï¼ˆDynaTreeï¼‰

**æ–¹å¼Aï¼šæ–‡æœ¬ç¼©è¿›**ï¼ˆç®€å•ï¼‰
```
the
â”œâ”€ mat âœ“ (correct!)
â”‚  â”œâ”€ . âœ“
â”‚  â”œâ”€ ,
â”‚  â””â”€ !
â”œâ”€ hat âœ— (wrong!)
â”‚  â”œâ”€ .
â”‚  â””â”€ ,
â””â”€ a âœ—
   â””â”€ ...
```

**æ–¹å¼Bï¼šå›¾å½¢**ï¼ˆæ›´ç›´è§‚ï¼‰
```
        â—‹ the
       /  |  \
      â—‹   â—‹   â—‹
     mat hat  a
     /|\  |\  |
    . , ! . , ...
    
Accepted: the â†’ mat â†’ . âœ“âœ“âœ“ (ç»¿è‰²)
Rejected: the â†’ hat, the â†’ a (ç°è‰²)
```

ç”¨**ç»¿è‰²ç²—çº¿**æ ‡æ³¨accepted pathï¼Œ**ç°è‰²è™šçº¿**æ ‡æ³¨rejected paths

#### 3. **Verificationç»“æœ**

**Linearç¤ºä¾‹**ï¼š
```
Draft candidates: [the, hat, ., and, ...]
Verification:      âœ“    âœ—   (stop - åç»­åºŸå¼ƒ)
Accept:           [the] only
```

**DynaTreeç¤ºä¾‹**ï¼š
```
Draft paths:
  - the â†’ mat â†’ .  âœ“âœ“âœ“ (accepted)
  - the â†’ hat â†’ .  âœ—âœ—âœ— (rejected)
  - the â†’ a â†’ ...  âœ—âœ—  (rejected)
  
Accept: [the, mat, .] (longest valid path)
```

ç”¨ä¸åŒé¢œè‰²åŒºåˆ†acceptedå’Œrejectedï¼Œç‰¹åˆ«æ ‡æ³¨Linearçš„æµªè´¹æƒ…å†µ

#### 4. **è¿­ä»£æ¬¡æ•°å¯¹æ¯”**ï¼ˆæœ€é‡è¦ï¼ï¼‰

æ¯ä¸ªæ–¹æ³•æœ€ä¸‹æ–¹ç”¨å¤§å­—æ ‡æ³¨ï¼š
```
AR:      â±ï¸  3 iterations
Linear:  â±ï¸  2 iterations
DynaTree: â±ï¸  1 iteration
```

è¿™æ˜¯æœ€ç›´è§‚çš„å¯¹æ¯”ï¼

---

## ğŸ“Š æœ€ç»ˆæ•ˆæœç¤ºæ„

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ Timeline Comparison: Generating "the mat."                      â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ (a) Autoregressive                                              â•‘
â•‘ â”â”â”â”â”â”â”â”â”“ â†’ â”â”â”â”â”â”â”â”â”“ â†’ â”â”â”â”â”â”â”â”â”“                              â•‘
â•‘ â”ƒ  LLM  â”ƒ   â”ƒ  LLM  â”ƒ   â”ƒ  LLM  â”ƒ   [æ¯æ¬¡1ä¸ªtoken]              â•‘
â•‘ â”ƒ  â†’the â”ƒ   â”ƒ  â†’mat â”ƒ   â”ƒ  â†’.   â”ƒ                              â•‘
â•‘ â”—â”â”â”â”â”â”â”â”›   â”—â”â”â”â”â”â”â”â”›   â”—â”â”â”â”â”â”â”â”›                              â•‘
â•‘ â±ï¸  3 iterations                                                 â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ (b) Linear Speculative                                          â•‘
â•‘ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“                        â•‘
â•‘ â”ƒ Draftâ†’[the,hat,..]â”ƒ  â†’  â”ƒ Draftâ†’[mat,.]  â”ƒ                    â•‘
â•‘ â”ƒ LLMâ†’âœ“âœ—(æµªè´¹!)    â”ƒ     â”ƒ LLMâ†’âœ“âœ“        â”ƒ                    â•‘
â•‘ â”ƒ Accept: the only â”ƒ     â”ƒ Accept: mat,. â”ƒ                    â•‘
â•‘ â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›     â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›                        â•‘
â•‘ â±ï¸  2 iterations (Early rejection wastes tokens!)               â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ (c) DynaTree                                                    â•‘
â•‘ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“                      â•‘
â•‘ â”ƒ Draft Tree:     the                    â”ƒ                      â•‘
â•‘ â”ƒ                /â”‚\                     â”ƒ                      â•‘
â•‘ â”ƒ              mat hat a                 â”ƒ  [å¹¶è¡Œæ¢ç´¢]           â•‘
â•‘ â”ƒ              /â”‚\ /â”‚\ /\                â”ƒ                      â•‘
â•‘ â”ƒ             . , ! . , ...              â”ƒ                      â•‘
â•‘ â”ƒ                                        â”ƒ                      â•‘
â•‘ â”ƒ LLM TreeVerify â†’ Best: theâ†’matâ†’. âœ“âœ“âœ“   â”ƒ  [haté”™äº†æ²¡å…³ç³»!]     â•‘
â•‘ â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›                      â•‘
â•‘ â±ï¸  1 iteration (Multiple paths explored!)                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

å¯¹æ¯”ï¼šARéœ€è¦3è½®ï¼ŒLinearéœ€è¦2è½®ï¼ŒDynaTreeåªéœ€1è½®ï¼
```

---

## âœ¨ æ ¸å¿ƒå¯¹æ¯”ï¼ˆè¡¨æ ¼å½¢å¼ï¼‰

ç”»å®Œåï¼Œå¯ä»¥åœ¨æ—è¾¹æˆ–ä¸‹æ–¹åŠ ä¸€ä¸ªå¯¹æ¯”è¡¨ï¼š

| Metric | AR | Linear | DynaTree |
|--------|----|----|----------|
| **Iterations** | 3 | 2 | 1 |
| **LLM Calls** | 3 | 2 | 1 |
| **Draft Calls** | 0 | 2 | 1 |
| **Tokens/Iter** | 1 | 1.5 | 3 |
| **Parallelism** | None | Batch | Tree |

è¿™ä¸ªè¡¨æ ¼èƒ½ä¸€çœ¼çœ‹å‡ºefficiencyå·®å¼‚ï¼

---

## ğŸ¯ ç»˜åˆ¶æ­¥éª¤ï¼ˆPowerPointï¼‰

### Step 1: ç”»ARéƒ¨åˆ†

1. æ’å…¥3ä¸ªè“è‰²çŸ©å½¢ï¼ˆ200Ã—150pxï¼‰
2. åœ¨æ¯ä¸ªæ¡†å†…æ·»åŠ æ–‡æœ¬æ¡†ï¼š
   ```
   Input: "...sat on"
   
        LLM
         â†“
   Output: the
   ```
3. ç”¨ç»†ç®­å¤´â†’è¿æ¥3ä¸ªæ¡†
4. ä¸‹æ–¹åŠ æ–‡å­—ï¼š"3 iterations"

### Step 2: ç”»Linearéƒ¨åˆ†

1. æ’å…¥2ä¸ªç»¿è‰²çŸ©å½¢ï¼ˆ350Ã—200pxï¼‰
2. ç¬¬1ä¸ªæ¡†å†…ï¼š
   ```
   1) Draft: [the, hat, ., and, ...]
   2) LLM Verify: âœ“ âœ— (stop!)
   3) Accept: [the] only
      (hat, ., and... éƒ½æµªè´¹äº†ï¼)
   ```
3. ç¬¬2ä¸ªæ¡†å†…ï¼š
   ```
   1) Draft: [mat, .]
   2) LLM Verify: âœ“ âœ“
   3) Accept: [mat, .]
   ```
4. ç”¨ç²—ç®­å¤´â‡’è¿æ¥
5. ä¸‹æ–¹åŠ æ–‡å­—ï¼š"2 iterations"
6. **é‡ç‚¹æ ‡æ³¨**: ç”¨çº¢è‰²åœˆå‡ºç¬¬1ä¸ªæ¡†é‡Œè¢«æµªè´¹çš„tokens

### Step 3: ç”»DynaTreeéƒ¨åˆ†

1. æ’å…¥1ä¸ªç´«è‰²çŸ©å½¢ï¼ˆ600Ã—250pxï¼‰
2. æ¡†å†…ç”»æ ‘ï¼š
   - æ’å…¥ â†’ SmartArt â†’ å±‚æ¬¡ç»“æ„
   - æˆ–æ‰‹åŠ¨ç”¨åœ†å½¢+ç›´çº¿
   - **ç¡®ä¿ç”»å‡ºå¤šä¸ªåˆ†æ”¯**: theâ†’mat, theâ†’hat, theâ†’a
   - ç”¨**ç»¿è‰²ç²—çº¿**æ ‡æ³¨accepted path: theâ†’matâ†’.
   - ç”¨**ç°è‰²è™šçº¿**æ ‡æ³¨rejected paths: theâ†’hat, theâ†’a
3. æ¡†å†…ä¸‹æ–¹åŠ æ–‡å­—ï¼š
   ```
   Paths explored:
   - theâ†’matâ†’. âœ“âœ“âœ“ (Best!)
   - theâ†’hatâ†’. âœ—âœ—âœ—
   - theâ†’aâ†’... âœ—âœ—
   ```
4. ä¸‹æ–¹åŠ æ–‡å­—ï¼š"1 iteration"
5. **é‡ç‚¹æ ‡æ³¨**: ç”¨å¯¹è¯æ¡†æ ‡æ³¨"å³ä½¿haté”™äº†ï¼Œmatè·¯å¾„ä»ç„¶æœ‰æ•ˆï¼"

### Step 4: æ·»åŠ å¯¹æ¯”å…ƒç´ 

1. æ¯ä¸ªæ–¹æ³•æœ€å·¦è¾¹åŠ ç°è‰²æ¡†ï¼š"Initial: The cat sat on"
2. æ¯ä¸ªæ–¹æ³•æœ€å³è¾¹åŠ ç°è‰²æ¡†ï¼š"Final: ...the mat."
3. ç”¨è™šçº¿è¿æ¥Initialå’ŒFinal
4. æœ€ä¸‹æ–¹åŠ æ€»ç»“è¡¨æ ¼ï¼ˆå¯é€‰ï¼‰

---

## ğŸ¨ æœ€ç»ˆæ£€æŸ¥æ¸…å•

ç»˜åˆ¶å®Œæˆåæ£€æŸ¥ï¼š

- [ ] ä¸‰ä¸ªæ–¹æ³•éƒ½ç”¨åŒä¸€ä¸ªä¾‹å­ï¼ˆcatï¼‰
- [ ] æ¯ä¸ªæ¡†éƒ½æœ‰Inputå’ŒOutputæ ‡æ³¨
- [ ] ARæœ‰3ä¸ªæ­¥éª¤ï¼ˆè“è‰²ï¼‰
- [ ] Linearæœ‰2ä¸ªè¿­ä»£ï¼ˆç»¿è‰²+æ©™è‰²ï¼‰
- [ ] DynaTreeæœ‰1ä¸ªè¿­ä»£ï¼ˆç´«è‰²+çº¢è‰²ï¼‰
- [ ] æ ‘çš„ç»“æ„æ¸…æ™°å¯è§
- [ ] Accepted tokensç”¨ç»¿è‰²âœ“æ ‡æ³¨
- [ ] Rejected candidatesç”¨ç°è‰²âœ—æ ‡æ³¨
- [ ] æ¯ä¸ªæ–¹æ³•æœ€ä¸‹æ–¹æœ‰"X iterations"æ€»ç»“
- [ ] æ•´ä½“å¯¹æ¯”ä¸€ç›®äº†ç„¶ï¼š3 vs 2 vs 1
- [ ] é¢œè‰²åŒºåˆ†æ˜æ˜¾
- [ ] å­—ä½“æ¸…æ™°æ˜“è¯»

---

## ğŸ¯ æ ¸å¿ƒä¿¡æ¯

**è¿™ä¸ªå›¾è¦ä¼ è¾¾çš„ä¿¡æ¯**ï¼š

1. **AR**: æ…¢ï¼Œæ¯æ¬¡1ä¸ªtokenï¼Œéœ€è¦3è½®
2. **Linear**: ä¸­ç­‰ï¼ŒDraft+Verifyï¼Œä½†æ—©æœŸæ‹’ç»ä¼šæµªè´¹åç»­tokensï¼Œéœ€è¦2è½®
3. **DynaTree**: å¿«ï¼ŒTree explorationå¹¶è¡Œæ¢ç´¢å¤šæ¡è·¯å¾„ï¼Œå³ä½¿éƒ¨åˆ†è·¯å¾„é”™è¯¯ä¹Ÿä¸å½±å“ï¼Œåªéœ€1è½®

**å…³é”®å¯¹æ¯”ï¼ˆç”¨è¿™ä¸ªcatä¾‹å­å±•ç¤ºçš„ï¼‰**ï¼š
- **AR**: "The cat sat on" â†’ "the" â†’ "mat" â†’ "." ï¼ˆ3æ­¥ï¼‰
- **Linear**: 
  - Iter 1: Draft [the, hat, ...] â†’ åªæ¥å—"the"ï¼Œ"hat"é”™äº†ï¼Œåç»­æµªè´¹
  - Iter 2: Draft [mat, .] â†’ éƒ½æ¥å—
- **DynaTree**: 
  - Iter 1: Draft Treeæœ‰"theâ†’mat"å’Œ"theâ†’hat"ä¸¤æ¡è·¯å¾„
  - å³ä½¿"hat"é”™äº†ï¼Œ"mat"è·¯å¾„ä»ç„¶æœ‰æ•ˆï¼Œä¸€æ¬¡å®Œæˆï¼

**è¯»è€…5ç§’å†…åº”è¯¥çœ‹å‡º**ï¼š

> DynaTreeé€šè¿‡æ ‘å½¢å¹¶è¡Œæ¢ç´¢å¤šæ¡è·¯å¾„ï¼Œå³ä½¿éƒ¨åˆ†è·¯å¾„é”™è¯¯ä¹Ÿä¸å½±å“ï¼ŒæŠŠ3è½®å‹ç¼©æˆ1è½®ï¼  
> Linearåœ¨Draftå‡ºé”™æ—¶ä¼šæµªè´¹åç»­tokensï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆTreeæ›´robustï¼

---

**è¿™å°±æ˜¯æœ€ç»ˆè®¾è®¡ï¼** 

ç»Ÿä¸€ç”¨catä¾‹å­ï¼Œæ¸…æ¥šå±•ç¤ºè¾“å…¥è¾“å‡ºï¼Œæœ€é‡è¦çš„æ˜¯å¯¹æ¯”è¿­ä»£æ¬¡æ•°ï¼š**3 vs 2 vs 1**ã€‚

---

## ğŸ”¬ **é™„å½•ï¼šéªŒè¯æœºåˆ¶è¯¦è§£ï¼ˆTechnical Detailsï¼‰**

### **é—®ï¼šAccept/Rejectæ˜¯LLMç”Ÿæˆçš„å—ï¼Ÿ**

**ç­”ï¼šä¸æ˜¯ï¼** éªŒè¯æœºåˆ¶æ˜¯è¿™æ ·çš„ï¼š

### **éªŒè¯æµç¨‹**

1. **LLMçš„ä½œç”¨**ï¼šå¯¹æ¯ä¸ªä½ç½®é¢„æµ‹ä¸‹ä¸€ä¸ªtokenï¼ˆä½¿ç”¨å…¶æ­£å¸¸çš„é¢„æµ‹èƒ½åŠ›ï¼‰
2. **æ¯”è¾ƒè¿‡ç¨‹**ï¼šå°†Draftæè®®çš„tokenä¸LLMé¢„æµ‹çš„tokenå¯¹æ¯”
3. **åˆ¤å®šè§„åˆ™**ï¼š
   - Draft token == LLM prediction (top-1) â†’ âœ“ Accept
   - Draft token â‰  LLM prediction â†’ âœ— Reject

---

### **Linear Speculativeçš„éªŒè¯**

```
Iteration 1: 
Draftç”Ÿæˆ: [the, hat, ., and, ...]

LLMéªŒè¯ï¼ˆæŒ‰é¡ºåºï¼‰ï¼š
  Position 1: "The cat sat on ___"
    LLMé¢„æµ‹: P(the)=0.8, P(a)=0.1, P(his)=0.05, ...
    Top-1 = "the"
    Draftæè®® = "the"
    æ¯”è¾ƒ: "the" == "the" â†’ âœ“ Acceptï¼Œç»§ç»­éªŒè¯
    
  Position 2: "The cat sat on the ___"
    LLMé¢„æµ‹: P(mat)=0.7, P(floor)=0.15, P(table)=0.1, ...
    Top-1 = "mat"
    Draftæè®® = "hat"
    æ¯”è¾ƒ: "mat" â‰  "hat" â†’ âœ— Rejectï¼Œåœæ­¢éªŒè¯ï¼
    
  Position 3+: ä¸å†éªŒè¯ï¼ˆå› ä¸ºPosition 2å·²ç»rejectï¼‰
  
æœ€ç»ˆAccept: [the] ï¼ˆåªæœ‰1ä¸ªtokenï¼‰
åç»­tokens [., and, ...] éƒ½è¢«æµªè´¹äº†ï¼
```

---

### **Tree Speculativeçš„éªŒè¯**

```
Draft Tree:
         the
        /â”‚\
      mat hat a
      /|\ /|\ |
     . , ! . , ...

LLMéªŒè¯ï¼ˆä½¿ç”¨Tree Attentionï¼Œä¸€æ¬¡å‰å‘ä¼ æ’­ï¼‰ï¼š

Level 1: "The cat sat on ___"
  LLMé¢„æµ‹: Top-1 = "the"
  Draftæœ‰: "the"
  ç»“æœ: "the" == "the" â†’ âœ“ Acceptï¼Œç»§ç»­éªŒè¯å­èŠ‚ç‚¹

Level 2: "The cat sat on the ___"
  LLMé¢„æµ‹: Top-1 = "mat"
  
  Draftæœ‰3ä¸ªå€™é€‰:
    - "mat": "mat" == "mat" â†’ âœ“ Acceptï¼Œç»§ç»­éªŒè¯å®ƒçš„å­èŠ‚ç‚¹
    - "hat": "hat" â‰  "mat" â†’ âœ— Rejectï¼Œä¸éªŒè¯å®ƒçš„å­èŠ‚ç‚¹
    - "a":   "a" â‰  "mat"   â†’ âœ— Rejectï¼Œä¸éªŒè¯å®ƒçš„å­èŠ‚ç‚¹

Level 3: "The cat sat on the mat ___"
  LLMé¢„æµ‹: Top-1 = "."
  Draftæœ‰: "." (åœ¨matåˆ†æ”¯ä¸‹)
  ç»“æœ: "." == "." â†’ âœ“ Accept

æœ€ç»ˆAccept: [the, mat, .] ï¼ˆ3ä¸ªtokensï¼Œæœ€é•¿æœ‰æ•ˆè·¯å¾„ï¼‰
```

---

### **å…³é”®åŒºåˆ«**

| æ–¹é¢ | Linear | Tree |
|------|--------|------|
| **éªŒè¯æ–¹å¼** | é¡ºåºéªŒè¯ï¼Œä¸€ä¸ªrejectå°±åœæ­¢ | å¹¶è¡ŒéªŒè¯æ‰€æœ‰è·¯å¾„ |
| **æ—©æœŸrejectçš„å½±å“** | åç»­æ‰€æœ‰tokensåºŸå¼ƒ | åªåºŸå¼ƒé‚£ä¸ªåˆ†æ”¯ï¼Œå…¶ä»–åˆ†æ”¯ä»æœ‰æ•ˆ |
| **LLMè°ƒç”¨æ¬¡æ•°** | æ¯è½®1æ¬¡ | æ¯è½®1æ¬¡ï¼ˆä½†éªŒè¯æ›´å¤šå€™é€‰ï¼‰ |
| **å®¹é”™èƒ½åŠ›** | ä½ï¼ˆå•è·¯å¾„ï¼‰ | é«˜ï¼ˆå¤šè·¯å¾„ï¼‰ |

---

### **ä¸ºä»€ä¹ˆTreeæ›´robustï¼Ÿ**

**ä¾‹å­**ï¼šå‡è®¾LLMé¢„æµ‹"mat"çš„æ¦‚ç‡åˆ†å¸ƒï¼š
```
P(mat) = 0.50  â† top-1, æ­£ç¡®ç­”æ¡ˆ
P(hat) = 0.30  â† Draftå¯èƒ½ä¹Ÿä¼šè€ƒè™‘è¿™ä¸ª
P(cat) = 0.15
P(bat) = 0.05
```

**Linearçš„é—®é¢˜**ï¼š
- Draftåªèƒ½ç”Ÿæˆä¸€æ¡é“¾ï¼Œå‡è®¾é€‰äº†"hat"ï¼ˆæ¦‚ç‡30%ï¼Œä¹Ÿä¸ä½ï¼‰
- ä½†LLM top-1æ˜¯"mat"ï¼Œæ‰€ä»¥"hat"è¢«reject
- å³ä½¿"mat"ä¹Ÿåœ¨Draft modelçš„top-ké‡Œï¼Œä¹Ÿæ¥ä¸åŠäº†ï¼

**Treeçš„ä¼˜åŠ¿**ï¼š
- DraftåŒæ—¶ç”Ÿæˆtop-kåˆ†æ”¯ï¼šmat, hat, cat
- LLMéªŒè¯æ—¶ï¼Œå‘ç°"mat"åŒ¹é…ï¼Œç›´æ¥acceptè¿™æ¡è·¯å¾„
- "hat"å’Œ"cat"åˆ†æ”¯è™½ç„¶è¢«rejectï¼Œä½†ä¸å½±å“"mat"åˆ†æ”¯
- ä¸€æ¬¡å°±å®Œæˆï¼

---

è¿™å°±æ˜¯ä¸ºä»€ä¹ˆTree-based Speculative Decodingæ¯”Linearæ›´é«˜æ•ˆæ›´robustï¼

