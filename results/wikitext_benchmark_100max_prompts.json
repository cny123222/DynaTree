{
  "benchmark_info": {
    "target_model": "/mnt/disk1/models/pythia-2.8b",
    "draft_model": "/mnt/disk1/models/pythia-70m",
    "dataset": "WikiText-2 (ModelScope)",
    "max_new_tokens": 500,
    "num_samples": 5,
    "warmup_runs": 2,
    "max_prompt_length": 100
  },
  "results": [
    {
      "method": "Baseline (AR)",
      "config": {},
      "ttft_ms": 12.314912118017673,
      "tpot_ms": 7.513519182056188,
      "total_latency_ms": 3769.074503146112,
      "throughput_tps": 132.66699804359808,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.0,
      "tokens_per_round": 0.0,
      "total_rounds": 0,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 1322762240000,
      "total_flops": 2720136560640,
      "flops_per_token": 2645524480.0,
      "peak_memory_mb": 5656.7109375,
      "speedup": 1.0
    },
    {
      "method": "Tree V2 (D=4, B=2, t=0.05)",
      "config": {
        "tree_depth": 4,
        "branch_factor": 2,
        "probability_threshold": 0.05
      },
      "ttft_ms": 9.561065770685673,
      "tpot_ms": 6.332769576832652,
      "total_latency_ms": 0.0,
      "throughput_tps": 158.77970982756318,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.8915103764461001,
      "tokens_per_round": 0.0,
      "total_rounds": 113,
      "avg_path_length": 4.4575518822305,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 9440850667520,
      "total_flops": 10838224988160,
      "flops_per_token": 18881701335.04,
      "peak_memory_mb": 5704.53466796875,
      "speedup": 1.1968289941661583
    },
    {
      "method": "Tree V2 (D=4, B=2, t=0.03)",
      "config": {
        "tree_depth": 4,
        "branch_factor": 2,
        "probability_threshold": 0.03
      },
      "ttft_ms": 9.506005980074406,
      "tpot_ms": 6.118437898159027,
      "total_latency_ms": 0.0,
      "throughput_tps": 163.75679312141997,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.9179984612913769,
      "tokens_per_round": 0.0,
      "total_rounds": 110,
      "avg_path_length": 4.589992306456884,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 9190208614400,
      "total_flops": 10587582935040,
      "flops_per_token": 18380417228.8,
      "peak_memory_mb": 5704.16943359375,
      "speedup": 1.2343446036790922
    },
    {
      "method": "Tree V2 (D=5, B=2, t=0.05)",
      "config": {
        "tree_depth": 5,
        "branch_factor": 2,
        "probability_threshold": 0.05
      },
      "ttft_ms": 9.662801027297974,
      "tpot_ms": 5.806864458695054,
      "total_latency_ms": 0.0,
      "throughput_tps": 172.56225535079457,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.8193218728228622,
      "tokens_per_round": 0.0,
      "total_rounds": 102,
      "avg_path_length": 4.915931236937174,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 17352248094720,
      "total_flops": 18749622415360,
      "flops_per_token": 34704496189.44,
      "peak_memory_mb": 5706.10400390625,
      "speedup": 1.3007172687670658
    },
    {
      "method": "Tree V2 (D=7, B=2, t=0.05)",
      "config": {
        "tree_depth": 7,
        "branch_factor": 2,
        "probability_threshold": 0.05
      },
      "ttft_ms": 9.547058306634426,
      "tpot_ms": 5.51965314745903,
      "total_latency_ms": 0.0,
      "throughput_tps": 182.18287595331498,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.694181796772303,
      "tokens_per_round": 0.0,
      "total_rounds": 91,
      "avg_path_length": 5.553454374178424,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 63390862080000,
      "total_flops": 64788236400640,
      "flops_per_token": 126781724160.0,
      "peak_memory_mb": 5704.798828125,
      "speedup": 1.373234328355305
    },
    {
      "method": "Tree V2 (D=6, B=2, t=0.05)",
      "config": {
        "tree_depth": 6,
        "branch_factor": 2,
        "probability_threshold": 0.05
      },
      "ttft_ms": 9.510943479835987,
      "tpot_ms": 5.614334226027131,
      "total_latency_ms": 0.0,
      "throughput_tps": 178.49469214537532,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.7613916352854406,
      "tokens_per_round": 0.0,
      "total_rounds": 95,
      "avg_path_length": 5.329741446998083,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 32705856051200,
      "total_flops": 34103230371840,
      "flops_per_token": 65411712102.4,
      "peak_memory_mb": 5703.837890625,
      "speedup": 1.3454340173335118
    },
    {
      "method": "HF Assisted",
      "config": {
        "num_assistant_tokens": 5
      },
      "ttft_ms": 9.473511576652527,
      "tpot_ms": 4.400586806237698,
      "total_latency_ms": 0.0,
      "throughput_tps": 228.97006038895432,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.0,
      "tokens_per_round": 0.0,
      "total_rounds": 0,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 0.0,
      "decode_flops": 0.0,
      "total_flops": 0.0,
      "flops_per_token": 0.0,
      "peak_memory_mb": 5669.083984375,
      "speedup": 1.7259006668237744
    },
    {
      "method": "Linear K=4",
      "config": {
        "K": 4
      },
      "ttft_ms": 9.537731483578682,
      "tpot_ms": 6.4627757500857115,
      "total_latency_ms": 0.0,
      "throughput_tps": 154.98563265922309,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.9917844990753022,
      "tokens_per_round": 3.967137996301209,
      "total_rounds": 126,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 1689589923840,
      "total_flops": 3086964244480,
      "flops_per_token": 3379179847.68,
      "peak_memory_mb": 5704.7294921875,
      "speedup": 1.1682304939792976
    },
    {
      "method": "Linear K=5",
      "config": {
        "K": 5
      },
      "ttft_ms": 9.39040258526802,
      "tpot_ms": 6.146442758291959,
      "total_latency_ms": 0.0,
      "throughput_tps": 163.19944193210856,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.8890130067607581,
      "tokens_per_round": 4.445065033803791,
      "total_rounds": 113,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 1819440445440,
      "total_flops": 3216814766080,
      "flops_per_token": 3638880890.88,
      "peak_memory_mb": 5704.875,
      "speedup": 1.2301434745548148
    },
    {
      "method": "Linear K=6",
      "config": {
        "K": 6
      },
      "ttft_ms": 9.313597902655602,
      "tpot_ms": 6.099475319683552,
      "total_latency_ms": 0.0,
      "throughput_tps": 166.28982663424895,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.8024674784225987,
      "tokens_per_round": 4.814804870535592,
      "total_rounds": 105,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 1973303808000,
      "total_flops": 3370678128640,
      "flops_per_token": 3946607616.0,
      "peak_memory_mb": 5705.1376953125,
      "speedup": 1.2534377734212503
    },
    {
      "method": "Linear K=7",
      "config": {
        "K": 7
      },
      "ttft_ms": 10.726261511445045,
      "tpot_ms": 7.885967525467277,
      "total_latency_ms": 0.0,
      "throughput_tps": 145.16047528490452,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.7444920821253527,
      "tokens_per_round": 5.211444574877468,
      "total_rounds": 97,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 2084124928000,
      "total_flops": 3481499248640,
      "flops_per_token": 4168249856.0,
      "peak_memory_mb": 5705.8583984375,
      "speedup": 1.0941717037812277
    },
    {
      "method": "Streaming K=5 cache=1024",
      "config": {
        "K": 5,
        "max_cache_len": 1024
      },
      "ttft_ms": 9.381536021828651,
      "tpot_ms": 6.165736465156078,
      "total_latency_ms": 0.0,
      "throughput_tps": 162.6935968359804,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.8890130067607581,
      "tokens_per_round": 0.0,
      "total_rounds": 0,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 0.0,
      "decode_flops": 0.0,
      "total_flops": 0.0,
      "flops_per_token": 0.0,
      "peak_memory_mb": 5704.875,
      "speedup": 1.2263305813440863
    },
    {
      "method": "Streaming K=6 cache=512",
      "config": {
        "K": 6,
        "max_cache_len": 512
      },
      "ttft_ms": 9.144330210983753,
      "tpot_ms": 6.075799794495106,
      "total_latency_ms": 0.0,
      "throughput_tps": 166.95750854362143,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.8024674784225987,
      "tokens_per_round": 0.0,
      "total_rounds": 0,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 0.0,
      "decode_flops": 0.0,
      "total_flops": 0.0,
      "flops_per_token": 0.0,
      "peak_memory_mb": 5705.1376953125,
      "speedup": 1.2584705390616777
    }
  ],
  "acceptance_comparison": {
    "linear_methods": [
      {
        "method": "Linear K=4",
        "acceptance_rate": 0.9917844990753022,
        "tokens_per_round": 3.967137996301209,
        "total_rounds": 126
      },
      {
        "method": "Linear K=5",
        "acceptance_rate": 0.8890130067607581,
        "tokens_per_round": 4.445065033803791,
        "total_rounds": 113
      },
      {
        "method": "Linear K=6",
        "acceptance_rate": 0.8024674784225987,
        "tokens_per_round": 4.814804870535592,
        "total_rounds": 105
      },
      {
        "method": "Linear K=7",
        "acceptance_rate": 0.7444920821253527,
        "tokens_per_round": 5.211444574877468,
        "total_rounds": 97
      }
    ],
    "tree_methods": [
      {
        "method": "Tree V2 (D=4, B=2, t=0.05)",
        "acceptance_rate": 0.8915103764461001,
        "avg_path_length": 4.4575518822305,
        "total_rounds": 113
      },
      {
        "method": "Tree V2 (D=4, B=2, t=0.03)",
        "acceptance_rate": 0.9179984612913769,
        "avg_path_length": 4.589992306456884,
        "total_rounds": 110
      },
      {
        "method": "Tree V2 (D=5, B=2, t=0.05)",
        "acceptance_rate": 0.8193218728228622,
        "avg_path_length": 4.915931236937174,
        "total_rounds": 102
      },
      {
        "method": "Tree V2 (D=7, B=2, t=0.05)",
        "acceptance_rate": 0.694181796772303,
        "avg_path_length": 5.553454374178424,
        "total_rounds": 91
      },
      {
        "method": "Tree V2 (D=6, B=2, t=0.05)",
        "acceptance_rate": 0.7613916352854406,
        "avg_path_length": 5.329741446998083,
        "total_rounds": 95
      }
    ],
    "analysis": {
      "avg_linear_acceptance": 0.856939266596003,
      "avg_linear_tokens_per_round": 4.6096131188795155,
      "avg_tree_acceptance": 0.8168808285236165,
      "avg_tree_path_length": 4.969334249360213
    }
  },
  "rankings": {
    "by_throughput": [
      {
        "rank": 1,
        "method": "HF Assisted",
        "throughput": 228.97006038895432,
        "speedup": 1.7259006668237744
      },
      {
        "rank": 2,
        "method": "Tree V2 (D=7, B=2, t=0.05)",
        "throughput": 182.18287595331498,
        "speedup": 1.373234328355305
      },
      {
        "rank": 3,
        "method": "Tree V2 (D=6, B=2, t=0.05)",
        "throughput": 178.49469214537532,
        "speedup": 1.3454340173335118
      },
      {
        "rank": 4,
        "method": "Tree V2 (D=5, B=2, t=0.05)",
        "throughput": 172.56225535079457,
        "speedup": 1.3007172687670658
      },
      {
        "rank": 5,
        "method": "Streaming K=6 cache=512",
        "throughput": 166.95750854362143,
        "speedup": 1.2584705390616777
      },
      {
        "rank": 6,
        "method": "Linear K=6",
        "throughput": 166.28982663424895,
        "speedup": 1.2534377734212503
      },
      {
        "rank": 7,
        "method": "Tree V2 (D=4, B=2, t=0.03)",
        "throughput": 163.75679312141997,
        "speedup": 1.2343446036790922
      },
      {
        "rank": 8,
        "method": "Linear K=5",
        "throughput": 163.19944193210856,
        "speedup": 1.2301434745548148
      },
      {
        "rank": 9,
        "method": "Streaming K=5 cache=1024",
        "throughput": 162.6935968359804,
        "speedup": 1.2263305813440863
      },
      {
        "rank": 10,
        "method": "Tree V2 (D=4, B=2, t=0.05)",
        "throughput": 158.77970982756318,
        "speedup": 1.1968289941661583
      },
      {
        "rank": 11,
        "method": "Linear K=4",
        "throughput": 154.98563265922309,
        "speedup": 1.1682304939792976
      },
      {
        "rank": 12,
        "method": "Linear K=7",
        "throughput": 145.16047528490452,
        "speedup": 1.0941717037812277
      },
      {
        "rank": 13,
        "method": "Baseline (AR)",
        "throughput": 132.66699804359808,
        "speedup": 1.0
      }
    ],
    "by_acceptance_rate": [
      {
        "rank": 1,
        "method": "Linear K=4",
        "acceptance_rate": 0.9917844990753022
      },
      {
        "rank": 2,
        "method": "Tree V2 (D=4, B=2, t=0.03)",
        "acceptance_rate": 0.9179984612913769
      },
      {
        "rank": 3,
        "method": "Tree V2 (D=4, B=2, t=0.05)",
        "acceptance_rate": 0.8915103764461001
      },
      {
        "rank": 4,
        "method": "Linear K=5",
        "acceptance_rate": 0.8890130067607581
      },
      {
        "rank": 5,
        "method": "Streaming K=5 cache=1024",
        "acceptance_rate": 0.8890130067607581
      },
      {
        "rank": 6,
        "method": "Tree V2 (D=5, B=2, t=0.05)",
        "acceptance_rate": 0.8193218728228622
      },
      {
        "rank": 7,
        "method": "Linear K=6",
        "acceptance_rate": 0.8024674784225987
      },
      {
        "rank": 8,
        "method": "Streaming K=6 cache=512",
        "acceptance_rate": 0.8024674784225987
      },
      {
        "rank": 9,
        "method": "Tree V2 (D=6, B=2, t=0.05)",
        "acceptance_rate": 0.7613916352854406
      },
      {
        "rank": 10,
        "method": "Linear K=7",
        "acceptance_rate": 0.7444920821253527
      },
      {
        "rank": 11,
        "method": "Tree V2 (D=7, B=2, t=0.05)",
        "acceptance_rate": 0.694181796772303
      }
    ]
  },
  "timestamp": "2026-01-03T16:26:19.198118"
}