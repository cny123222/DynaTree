{
  "benchmark_info": {
    "target_model": "/mnt/disk1/models/pythia-2.8b",
    "draft_model": "/mnt/disk1/models/pythia-70m",
    "dataset": "WikiText-2 (ModelScope)",
    "max_new_tokens": 200,
    "num_samples": 10,
    "warmup_runs": 2
  },
  "results": [
    {
      "method": "Baseline (AR)",
      "config": {},
      "ttft_ms": 17.565415240824223,
      "tpot_ms": 7.907317016739398,
      "total_latency_ms": 1599.0288185887039,
      "throughput_tps": 125.67029902768664,
      "total_tokens_generated": 200,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.0,
      "tokens_per_round": 0.0,
      "total_rounds": 0,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 529104896000,
      "total_flops": 1926479216640,
      "flops_per_token": 2645524480.0,
      "peak_memory_mb": 5603.96337890625,
      "speedup": 1.0
    },
    {
      "method": "Tree V2 (D=4, B=2, t=0.05)",
      "config": {
        "tree_depth": 4,
        "branch_factor": 2,
        "probability_threshold": 0.05
      },
      "ttft_ms": 10.827313922345638,
      "tpot_ms": 6.889172472525388,
      "total_latency_ms": 0.0,
      "throughput_tps": 147.86466560938814,
      "total_tokens_generated": 200,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.8288784361768219,
      "tokens_per_round": 0.0,
      "total_rounds": 50,
      "avg_path_length": 4.14439218088411,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 4177367552000,
      "total_flops": 5574741872640,
      "flops_per_token": 20886837760.0,
      "peak_memory_mb": 5611.55029296875,
      "speedup": 1.1766078918680047
    },
    {
      "method": "Tree V2 (D=4, B=2, t=0.03)",
      "config": {
        "tree_depth": 4,
        "branch_factor": 2,
        "probability_threshold": 0.03
      },
      "ttft_ms": 10.828862618654966,
      "tpot_ms": 6.569148966111243,
      "total_latency_ms": 0.0,
      "throughput_tps": 154.38623914166925,
      "total_tokens_generated": 200,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.8708463674836411,
      "tokens_per_round": 0.0,
      "total_rounds": 47,
      "avg_path_length": 4.354231837418206,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 3926725498880,
      "total_flops": 5324099819520,
      "flops_per_token": 19633627494.4,
      "peak_memory_mb": 5612.57958984375,
      "speedup": 1.2285022024786951
    },
    {
      "method": "Tree V2 (D=5, B=2, t=0.05)",
      "config": {
        "tree_depth": 5,
        "branch_factor": 2,
        "probability_threshold": 0.05
      },
      "ttft_ms": 10.74393168091774,
      "tpot_ms": 6.502175805158913,
      "total_latency_ms": 0.0,
      "throughput_tps": 158.5236213590968,
      "total_tokens_generated": 200,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.7464417584063917,
      "tokens_per_round": 0.0,
      "total_rounds": 47,
      "avg_path_length": 4.478650550438351,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 7995643729920,
      "total_flops": 9393018050560,
      "flops_per_token": 39978218649.6,
      "peak_memory_mb": 5613.0849609375,
      "speedup": 1.2614247167834955
    },
    {
      "method": "Tree V2 (D=7, B=2, t=0.05)",
      "config": {
        "tree_depth": 7,
        "branch_factor": 2,
        "probability_threshold": 0.05
      },
      "ttft_ms": 10.795510560274124,
      "tpot_ms": 6.283303974661976,
      "total_latency_ms": 0.0,
      "throughput_tps": 163.2282704052096,
      "total_tokens_generated": 200,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.6245302049248715,
      "tokens_per_round": 0.0,
      "total_rounds": 43,
      "avg_path_length": 4.996241639398972,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 29953923840000,
      "total_flops": 31351298160640,
      "flops_per_token": 149769619200.0,
      "peak_memory_mb": 5612.70556640625,
      "speedup": 1.2988611602591038
    },
    {
      "method": "Tree V2 (D=6, B=2, t=0.05)",
      "config": {
        "tree_depth": 6,
        "branch_factor": 2,
        "probability_threshold": 0.05
      },
      "ttft_ms": 10.783168580383062,
      "tpot_ms": 6.234863770660013,
      "total_latency_ms": 0.0,
      "throughput_tps": 166.21045828784233,
      "total_tokens_generated": 200,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.7012767982195227,
      "tokens_per_round": 0.0,
      "total_rounds": 43,
      "avg_path_length": 4.90893758753666,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 14803703265280,
      "total_flops": 16201077585920,
      "flops_per_token": 74018516326.4,
      "peak_memory_mb": 5612.61767578125,
      "speedup": 1.3225914124006677
    },
    {
      "method": "HF Assisted",
      "config": {
        "num_assistant_tokens": 5
      },
      "ttft_ms": 10.765474569052458,
      "tpot_ms": 5.340250047389418,
      "total_latency_ms": 0.0,
      "throughput_tps": 194.44381774461672,
      "total_tokens_generated": 200,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.0,
      "tokens_per_round": 0.0,
      "total_rounds": 0,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 0.0,
      "decode_flops": 0.0,
      "total_flops": 0.0,
      "flops_per_token": 0.0,
      "peak_memory_mb": 5603.7431640625,
      "speedup": 1.5472535614941003
    },
    {
      "method": "Linear K=4",
      "config": {
        "K": 4
      },
      "ttft_ms": 10.835731122642756,
      "tpot_ms": 7.613580360542983,
      "total_latency_ms": 0.0,
      "throughput_tps": 134.14079092586041,
      "total_tokens_generated": 200,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.885778583299371,
      "tokens_per_round": 3.543114333197484,
      "total_rounds": 58,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 777747742720,
      "total_flops": 2175122063360,
      "flops_per_token": 3888738713.6,
      "peak_memory_mb": 5600.87451171875,
      "speedup": 1.0674024965621163
    },
    {
      "method": "Linear K=5",
      "config": {
        "K": 5
      },
      "ttft_ms": 10.873331222683191,
      "tpot_ms": 7.456310739275068,
      "total_latency_ms": 0.0,
      "throughput_tps": 138.59183402773004,
      "total_tokens_generated": 200,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.7774129664258389,
      "tokens_per_round": 3.8870648321291954,
      "total_rounds": 53,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 853365872640,
      "total_flops": 2250740193280,
      "flops_per_token": 4266829363.2,
      "peak_memory_mb": 5601.939453125,
      "speedup": 1.1028209139312755
    },
    {
      "method": "Linear K=6",
      "config": {
        "K": 6
      },
      "ttft_ms": 10.847925301641226,
      "tpot_ms": 7.402210205793381,
      "total_latency_ms": 0.0,
      "throughput_tps": 141.79323175730002,
      "total_tokens_generated": 200,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.702731822560265,
      "tokens_per_round": 4.21639093536159,
      "total_rounds": 50,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 939668480000,
      "total_flops": 2337042800640,
      "flops_per_token": 4698342400.0,
      "peak_memory_mb": 5603.48046875,
      "speedup": 1.128295491093415
    },
    {
      "method": "Linear K=7",
      "config": {
        "K": 7
      },
      "ttft_ms": 10.799409169703722,
      "tpot_ms": 7.471236541867256,
      "total_latency_ms": 0.0,
      "throughput_tps": 141.40072554673748,
      "total_tokens_generated": 200,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.6405770376140218,
      "tokens_per_round": 4.484039263298152,
      "total_rounds": 47,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 1009833728000,
      "total_flops": 2407208048640,
      "flops_per_token": 5049168640.0,
      "peak_memory_mb": 5604.18017578125,
      "speedup": 1.1251721897756066
    },
    {
      "method": "Streaming K=5 cache=1024",
      "config": {
        "K": 5,
        "max_cache_len": 1024
      },
      "ttft_ms": 10.866359993815422,
      "tpot_ms": 7.403831302188337,
      "total_latency_ms": 0.0,
      "throughput_tps": 139.57610977222313,
      "total_tokens_generated": 200,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.7774129664258389,
      "tokens_per_round": 0.0,
      "total_rounds": 0,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 0.0,
      "decode_flops": 0.0,
      "total_flops": 0.0,
      "flops_per_token": 0.0,
      "peak_memory_mb": 5601.939453125,
      "speedup": 1.1106531205235128
    },
    {
      "method": "Streaming K=6 cache=512",
      "config": {
        "K": 6,
        "max_cache_len": 512
      },
      "ttft_ms": 10.731743834912777,
      "tpot_ms": 7.437351883389056,
      "total_latency_ms": 0.0,
      "throughput_tps": 141.1328869215459,
      "total_tokens_generated": 200,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.702731822560265,
      "tokens_per_round": 0.0,
      "total_rounds": 0,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 0.0,
      "decode_flops": 0.0,
      "total_flops": 0.0,
      "flops_per_token": 0.0,
      "peak_memory_mb": 5603.48046875,
      "speedup": 1.1230409095346598
    }
  ],
  "acceptance_comparison": {
    "linear_methods": [
      {
        "method": "Linear K=4",
        "acceptance_rate": 0.885778583299371,
        "tokens_per_round": 3.543114333197484,
        "total_rounds": 58
      },
      {
        "method": "Linear K=5",
        "acceptance_rate": 0.7774129664258389,
        "tokens_per_round": 3.8870648321291954,
        "total_rounds": 53
      },
      {
        "method": "Linear K=6",
        "acceptance_rate": 0.702731822560265,
        "tokens_per_round": 4.21639093536159,
        "total_rounds": 50
      },
      {
        "method": "Linear K=7",
        "acceptance_rate": 0.6405770376140218,
        "tokens_per_round": 4.484039263298152,
        "total_rounds": 47
      }
    ],
    "tree_methods": [
      {
        "method": "Tree V2 (D=4, B=2, t=0.05)",
        "acceptance_rate": 0.8288784361768219,
        "avg_path_length": 4.14439218088411,
        "total_rounds": 50
      },
      {
        "method": "Tree V2 (D=4, B=2, t=0.03)",
        "acceptance_rate": 0.8708463674836411,
        "avg_path_length": 4.354231837418206,
        "total_rounds": 47
      },
      {
        "method": "Tree V2 (D=5, B=2, t=0.05)",
        "acceptance_rate": 0.7464417584063917,
        "avg_path_length": 4.478650550438351,
        "total_rounds": 47
      },
      {
        "method": "Tree V2 (D=7, B=2, t=0.05)",
        "acceptance_rate": 0.6245302049248715,
        "avg_path_length": 4.996241639398972,
        "total_rounds": 43
      },
      {
        "method": "Tree V2 (D=6, B=2, t=0.05)",
        "acceptance_rate": 0.7012767982195227,
        "avg_path_length": 4.90893758753666,
        "total_rounds": 43
      }
    ],
    "analysis": {
      "avg_linear_acceptance": 0.7516251024748741,
      "avg_linear_tokens_per_round": 4.032652340996606,
      "avg_tree_acceptance": 0.7543947130422497,
      "avg_tree_path_length": 4.576490759135259
    }
  },
  "rankings": {
    "by_throughput": [
      {
        "rank": 1,
        "method": "HF Assisted",
        "throughput": 194.44381774461672,
        "speedup": 1.5472535614941003
      },
      {
        "rank": 2,
        "method": "Tree V2 (D=6, B=2, t=0.05)",
        "throughput": 166.21045828784233,
        "speedup": 1.3225914124006677
      },
      {
        "rank": 3,
        "method": "Tree V2 (D=7, B=2, t=0.05)",
        "throughput": 163.2282704052096,
        "speedup": 1.2988611602591038
      },
      {
        "rank": 4,
        "method": "Tree V2 (D=5, B=2, t=0.05)",
        "throughput": 158.5236213590968,
        "speedup": 1.2614247167834955
      },
      {
        "rank": 5,
        "method": "Tree V2 (D=4, B=2, t=0.03)",
        "throughput": 154.38623914166925,
        "speedup": 1.2285022024786951
      },
      {
        "rank": 6,
        "method": "Tree V2 (D=4, B=2, t=0.05)",
        "throughput": 147.86466560938814,
        "speedup": 1.1766078918680047
      },
      {
        "rank": 7,
        "method": "Linear K=6",
        "throughput": 141.79323175730002,
        "speedup": 1.128295491093415
      },
      {
        "rank": 8,
        "method": "Linear K=7",
        "throughput": 141.40072554673748,
        "speedup": 1.1251721897756066
      },
      {
        "rank": 9,
        "method": "Streaming K=6 cache=512",
        "throughput": 141.1328869215459,
        "speedup": 1.1230409095346598
      },
      {
        "rank": 10,
        "method": "Streaming K=5 cache=1024",
        "throughput": 139.57610977222313,
        "speedup": 1.1106531205235128
      },
      {
        "rank": 11,
        "method": "Linear K=5",
        "throughput": 138.59183402773004,
        "speedup": 1.1028209139312755
      },
      {
        "rank": 12,
        "method": "Linear K=4",
        "throughput": 134.14079092586041,
        "speedup": 1.0674024965621163
      },
      {
        "rank": 13,
        "method": "Baseline (AR)",
        "throughput": 125.67029902768664,
        "speedup": 1.0
      }
    ],
    "by_acceptance_rate": [
      {
        "rank": 1,
        "method": "Linear K=4",
        "acceptance_rate": 0.885778583299371
      },
      {
        "rank": 2,
        "method": "Tree V2 (D=4, B=2, t=0.03)",
        "acceptance_rate": 0.8708463674836411
      },
      {
        "rank": 3,
        "method": "Tree V2 (D=4, B=2, t=0.05)",
        "acceptance_rate": 0.8288784361768219
      },
      {
        "rank": 4,
        "method": "Linear K=5",
        "acceptance_rate": 0.7774129664258389
      },
      {
        "rank": 5,
        "method": "Streaming K=5 cache=1024",
        "acceptance_rate": 0.7774129664258389
      },
      {
        "rank": 6,
        "method": "Tree V2 (D=5, B=2, t=0.05)",
        "acceptance_rate": 0.7464417584063917
      },
      {
        "rank": 7,
        "method": "Linear K=6",
        "acceptance_rate": 0.702731822560265
      },
      {
        "rank": 8,
        "method": "Streaming K=6 cache=512",
        "acceptance_rate": 0.702731822560265
      },
      {
        "rank": 9,
        "method": "Tree V2 (D=6, B=2, t=0.05)",
        "acceptance_rate": 0.7012767982195227
      },
      {
        "rank": 10,
        "method": "Linear K=7",
        "acceptance_rate": 0.6405770376140218
      },
      {
        "rank": 11,
        "method": "Tree V2 (D=7, B=2, t=0.05)",
        "acceptance_rate": 0.6245302049248715
      }
    ]
  },
  "timestamp": "2026-01-03T17:08:08.460785"
}