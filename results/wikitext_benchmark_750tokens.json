{
  "benchmark_info": {
    "target_model": "/mnt/disk1/models/pythia-2.8b",
    "draft_model": "/mnt/disk1/models/pythia-70m",
    "dataset": "WikiText-2 (ModelScope)",
    "max_new_tokens": 750,
    "num_samples": 5,
    "warmup_runs": 3,
    "max_prompt_length": 800
  },
  "results": [
    {
      "method": "Baseline (AR)",
      "config": {},
      "ttft_ms": 15.606673248112202,
      "tpot_ms": 7.65875413318475,
      "total_latency_ms": 5759.672273136675,
      "throughput_tps": 130.21774926991694,
      "total_tokens_generated": 750,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.0,
      "tokens_per_round": 0.0,
      "total_rounds": 0,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 1984143360000,
      "total_flops": 3381517680640,
      "flops_per_token": 2645524480.0,
      "peak_memory_mb": 5863.62353515625,
      "speedup": 1.0
    },
    {
      "method": "Tree V2 (D=4, B=2, t=0.05)",
      "config": {
        "tree_depth": 4,
        "branch_factor": 2,
        "probability_threshold": 0.05
      },
      "ttft_ms": 12.28521540760994,
      "tpot_ms": 5.563541136682034,
      "total_latency_ms": 0.0,
      "throughput_tps": 180.38411008600005,
      "total_tokens_generated": 750,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 1.0290654742388832,
      "tokens_per_round": 0.0,
      "total_rounds": 146,
      "avg_path_length": 5.1453273711944165,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 12197913251840,
      "total_flops": 13595287572480,
      "flops_per_token": 16263884335.786667,
      "peak_memory_mb": 5889.1953125,
      "speedup": 1.3852497919626738
    },
    {
      "method": "Tree V2 (D=4, B=2, t=0.03)",
      "config": {
        "tree_depth": 4,
        "branch_factor": 2,
        "probability_threshold": 0.03
      },
      "ttft_ms": 12.125866487622261,
      "tpot_ms": 5.48730803206563,
      "total_latency_ms": 0.0,
      "throughput_tps": 183.37139161984527,
      "total_tokens_generated": 750,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 1.029094337990498,
      "tokens_per_round": 0.0,
      "total_rounds": 147,
      "avg_path_length": 5.14547168995249,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 12281460602880,
      "total_flops": 13678834923520,
      "flops_per_token": 16375280803.84,
      "peak_memory_mb": 5890.650390625,
      "speedup": 1.4081904552024687
    },
    {
      "method": "Tree V2 (D=5, B=2, t=0.05)",
      "config": {
        "tree_depth": 5,
        "branch_factor": 2,
        "probability_threshold": 0.05
      },
      "ttft_ms": 12.00869083404541,
      "tpot_ms": 5.407603066414595,
      "total_latency_ms": 0.0,
      "throughput_tps": 185.01102988919462,
      "total_tokens_generated": 750,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.9108600273623626,
      "tokens_per_round": 0.0,
      "total_rounds": 138,
      "avg_path_length": 5.465160164174176,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 23476570951680,
      "total_flops": 24873945272320,
      "flops_per_token": 31302094602.24,
      "peak_memory_mb": 5890.83203125,
      "speedup": 1.4207819665635713
    },
    {
      "method": "Tree V2 (D=7, B=2, t=0.05)",
      "config": {
        "tree_depth": 7,
        "branch_factor": 2,
        "probability_threshold": 0.05
      },
      "ttft_ms": 11.897535063326359,
      "tpot_ms": 5.20218619753917,
      "total_latency_ms": 0.0,
      "throughput_tps": 192.04951339771162,
      "total_tokens_generated": 750,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.7810335228081988,
      "tokens_per_round": 0.0,
      "total_rounds": 120,
      "avg_path_length": 6.248268182465591,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 83592345600000,
      "total_flops": 84989719920640,
      "flops_per_token": 111456460800.0,
      "peak_memory_mb": 5886.36328125,
      "speedup": 1.4748336111971114
    },
    {
      "method": "Tree V2 (D=6, B=2, t=0.05)",
      "config": {
        "tree_depth": 6,
        "branch_factor": 2,
        "probability_threshold": 0.05
      },
      "ttft_ms": 11.980289220809937,
      "tpot_ms": 5.363541097939015,
      "total_latency_ms": 0.0,
      "throughput_tps": 186.0499084010881,
      "total_tokens_generated": 750,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.8267244874998987,
      "tokens_per_round": 0.0,
      "total_rounds": 130,
      "avg_path_length": 5.787071412499291,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 44755381964800,
      "total_flops": 46152756285440,
      "flops_per_token": 59673842619.73333,
      "peak_memory_mb": 5889.9814453125,
      "speedup": 1.4287599766099595
    },
    {
      "method": "HF Assisted",
      "config": {
        "num_assistant_tokens": 5
      },
      "ttft_ms": 11.961704306304455,
      "tpot_ms": 4.211986165245374,
      "total_latency_ms": 0.0,
      "throughput_tps": 251.24406900056653,
      "total_tokens_generated": 750,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.0,
      "tokens_per_round": 0.0,
      "total_rounds": 0,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 0.0,
      "decode_flops": 0.0,
      "total_flops": 0.0,
      "flops_per_token": 0.0,
      "peak_memory_mb": 5801.32421875,
      "speedup": 1.9294149254552446
    },
    {
      "method": "Linear K=4",
      "config": {
        "K": 4
      },
      "ttft_ms": 12.091423943638802,
      "tpot_ms": 5.984174529463052,
      "total_latency_ms": 0.0,
      "throughput_tps": 167.94530138969304,
      "total_tokens_generated": 750,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 1.0870507851065154,
      "tokens_per_round": 4.348203140426062,
      "total_rounds": 173,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 2319833784320,
      "total_flops": 3717208104960,
      "flops_per_token": 3093111712.4266667,
      "peak_memory_mb": 5879.33544921875,
      "speedup": 1.2897266488731423
    },
    {
      "method": "Linear K=5",
      "config": {
        "K": 5
      },
      "ttft_ms": 13.232533819973469,
      "tpot_ms": 5.941904949148496,
      "total_latency_ms": 0.0,
      "throughput_tps": 171.205481499993,
      "total_tokens_generated": 750,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.9484396673259511,
      "tokens_per_round": 4.742198336629754,
      "total_rounds": 161,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 2592300103680,
      "total_flops": 3989674424320,
      "flops_per_token": 3456400138.24,
      "peak_memory_mb": 5878.33984375,
      "speedup": 1.314763021630148
    },
    {
      "method": "Linear K=6",
      "config": {
        "K": 6
      },
      "ttft_ms": 12.002245150506496,
      "tpot_ms": 5.061613972485064,
      "total_latency_ms": 0.0,
      "throughput_tps": 199.40463363622538,
      "total_tokens_generated": 750,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.9758264945939024,
      "tokens_per_round": 5.854958967563414,
      "total_rounds": 129,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 2424344678400,
      "total_flops": 3821718999040,
      "flops_per_token": 3232459571.2,
      "peak_memory_mb": 5877.4921875,
      "speedup": 1.531316850077765
    },
    {
      "method": "Linear K=7",
      "config": {
        "K": 7
      },
      "ttft_ms": 11.921010538935661,
      "tpot_ms": 4.834325725585222,
      "total_latency_ms": 0.0,
      "throughput_tps": 210.6898552677832,
      "total_tokens_generated": 750,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.9337907631895896,
      "tokens_per_round": 6.536535342327127,
      "total_rounds": 117,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 2513841408000,
      "total_flops": 3911215728640,
      "flops_per_token": 3351788544.0,
      "peak_memory_mb": 5878.73193359375,
      "speedup": 1.6179810851365792
    },
    {
      "method": "Streaming K=5 cache=1024",
      "config": {
        "K": 5,
        "max_cache_len": 1024
      },
      "ttft_ms": 11.981073580682278,
      "tpot_ms": 5.953215980281432,
      "total_latency_ms": 0.0,
      "throughput_tps": 170.9073862550071,
      "total_tokens_generated": 750,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.9484396673259511,
      "tokens_per_round": 0.0,
      "total_rounds": 0,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 0.0,
      "decode_flops": 0.0,
      "total_flops": 0.0,
      "flops_per_token": 0.0,
      "peak_memory_mb": 5878.33984375,
      "speedup": 1.3124738156911944
    },
    {
      "method": "Streaming K=6 cache=512",
      "config": {
        "K": 6,
        "max_cache_len": 512
      },
      "ttft_ms": 11.917638406157494,
      "tpot_ms": 5.069239766895771,
      "total_latency_ms": 0.0,
      "throughput_tps": 199.0642685364778,
      "total_tokens_generated": 750,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.9758264945939024,
      "tokens_per_round": 0.0,
      "total_rounds": 0,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 0.0,
      "decode_flops": 0.0,
      "total_flops": 0.0,
      "flops_per_token": 0.0,
      "peak_memory_mb": 5877.4921875,
      "speedup": 1.528703035128145
    }
  ],
  "acceptance_comparison": {
    "linear_methods": [
      {
        "method": "Linear K=4",
        "acceptance_rate": 1.0870507851065154,
        "tokens_per_round": 4.348203140426062,
        "total_rounds": 173
      },
      {
        "method": "Linear K=5",
        "acceptance_rate": 0.9484396673259511,
        "tokens_per_round": 4.742198336629754,
        "total_rounds": 161
      },
      {
        "method": "Linear K=6",
        "acceptance_rate": 0.9758264945939024,
        "tokens_per_round": 5.854958967563414,
        "total_rounds": 129
      },
      {
        "method": "Linear K=7",
        "acceptance_rate": 0.9337907631895896,
        "tokens_per_round": 6.536535342327127,
        "total_rounds": 117
      }
    ],
    "tree_methods": [
      {
        "method": "Tree V2 (D=4, B=2, t=0.05)",
        "acceptance_rate": 1.0290654742388832,
        "avg_path_length": 5.1453273711944165,
        "total_rounds": 146
      },
      {
        "method": "Tree V2 (D=4, B=2, t=0.03)",
        "acceptance_rate": 1.029094337990498,
        "avg_path_length": 5.14547168995249,
        "total_rounds": 147
      },
      {
        "method": "Tree V2 (D=5, B=2, t=0.05)",
        "acceptance_rate": 0.9108600273623626,
        "avg_path_length": 5.465160164174176,
        "total_rounds": 138
      },
      {
        "method": "Tree V2 (D=7, B=2, t=0.05)",
        "acceptance_rate": 0.7810335228081988,
        "avg_path_length": 6.248268182465591,
        "total_rounds": 120
      },
      {
        "method": "Tree V2 (D=6, B=2, t=0.05)",
        "acceptance_rate": 0.8267244874998987,
        "avg_path_length": 5.787071412499291,
        "total_rounds": 130
      }
    ],
    "analysis": {
      "avg_linear_acceptance": 0.9862769275539895,
      "avg_linear_tokens_per_round": 5.37047394673659,
      "avg_tree_acceptance": 0.9153555699799683,
      "avg_tree_path_length": 5.558259764057192
    }
  },
  "rankings": {
    "by_throughput": [
      {
        "rank": 1,
        "method": "HF Assisted",
        "throughput": 251.24406900056653,
        "speedup": 1.9294149254552446
      },
      {
        "rank": 2,
        "method": "Linear K=7",
        "throughput": 210.6898552677832,
        "speedup": 1.6179810851365792
      },
      {
        "rank": 3,
        "method": "Linear K=6",
        "throughput": 199.40463363622538,
        "speedup": 1.531316850077765
      },
      {
        "rank": 4,
        "method": "Streaming K=6 cache=512",
        "throughput": 199.0642685364778,
        "speedup": 1.528703035128145
      },
      {
        "rank": 5,
        "method": "Tree V2 (D=7, B=2, t=0.05)",
        "throughput": 192.04951339771162,
        "speedup": 1.4748336111971114
      },
      {
        "rank": 6,
        "method": "Tree V2 (D=6, B=2, t=0.05)",
        "throughput": 186.0499084010881,
        "speedup": 1.4287599766099595
      },
      {
        "rank": 7,
        "method": "Tree V2 (D=5, B=2, t=0.05)",
        "throughput": 185.01102988919462,
        "speedup": 1.4207819665635713
      },
      {
        "rank": 8,
        "method": "Tree V2 (D=4, B=2, t=0.03)",
        "throughput": 183.37139161984527,
        "speedup": 1.4081904552024687
      },
      {
        "rank": 9,
        "method": "Tree V2 (D=4, B=2, t=0.05)",
        "throughput": 180.38411008600005,
        "speedup": 1.3852497919626738
      },
      {
        "rank": 10,
        "method": "Linear K=5",
        "throughput": 171.205481499993,
        "speedup": 1.314763021630148
      },
      {
        "rank": 11,
        "method": "Streaming K=5 cache=1024",
        "throughput": 170.9073862550071,
        "speedup": 1.3124738156911944
      },
      {
        "rank": 12,
        "method": "Linear K=4",
        "throughput": 167.94530138969304,
        "speedup": 1.2897266488731423
      },
      {
        "rank": 13,
        "method": "Baseline (AR)",
        "throughput": 130.21774926991694,
        "speedup": 1.0
      }
    ],
    "by_acceptance_rate": [
      {
        "rank": 1,
        "method": "Linear K=4",
        "acceptance_rate": 1.0870507851065154
      },
      {
        "rank": 2,
        "method": "Tree V2 (D=4, B=2, t=0.03)",
        "acceptance_rate": 1.029094337990498
      },
      {
        "rank": 3,
        "method": "Tree V2 (D=4, B=2, t=0.05)",
        "acceptance_rate": 1.0290654742388832
      },
      {
        "rank": 4,
        "method": "Linear K=6",
        "acceptance_rate": 0.9758264945939024
      },
      {
        "rank": 5,
        "method": "Streaming K=6 cache=512",
        "acceptance_rate": 0.9758264945939024
      },
      {
        "rank": 6,
        "method": "Linear K=5",
        "acceptance_rate": 0.9484396673259511
      },
      {
        "rank": 7,
        "method": "Streaming K=5 cache=1024",
        "acceptance_rate": 0.9484396673259511
      },
      {
        "rank": 8,
        "method": "Linear K=7",
        "acceptance_rate": 0.9337907631895896
      },
      {
        "rank": 9,
        "method": "Tree V2 (D=5, B=2, t=0.05)",
        "acceptance_rate": 0.9108600273623626
      },
      {
        "rank": 10,
        "method": "Tree V2 (D=6, B=2, t=0.05)",
        "acceptance_rate": 0.8267244874998987
      },
      {
        "rank": 11,
        "method": "Tree V2 (D=7, B=2, t=0.05)",
        "acceptance_rate": 0.7810335228081988
      }
    ]
  },
  "timestamp": "2026-01-03T16:25:29.344889"
}