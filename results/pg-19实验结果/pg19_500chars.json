{
  "benchmark_info": {
    "target_model": "/mnt/disk1/models/pythia-2.8b",
    "draft_model": "/mnt/disk1/models/pythia-70m",
    "dataset": "PG19 (Project Gutenberg)",
    "data_path": "/mnt/disk1/ljm/LLM-Efficient-Reasoning/data/pg19.parquet",
    "max_new_tokens": 500,
    "num_samples": 10,
    "warmup_runs": 2,
    "max_prompt_length": 5000
  },
  "results": [
    {
      "method": "Baseline (AR)",
      "config": {},
      "ttft_ms": 16.7235285975039,
      "tpot_ms": 7.5067359762266275,
      "total_latency_ms": 3770.091516710818,
      "throughput_tps": 132.6246769174296,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.0,
      "tokens_per_round": 0.0,
      "total_rounds": 0,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 1322762240000,
      "total_flops": 2720136560640,
      "flops_per_token": 2645524480.0,
      "peak_memory_mb": 6382.44189453125,
      "speedup": 1.0
    },
    {
      "method": "Tree V2 (D=4, B=2, t=0.05)",
      "config": {
        "tree_depth": 4,
        "branch_factor": 2,
        "probability_threshold": 0.05
      },
      "ttft_ms": 18.78773234784603,
      "tpot_ms": 8.825020592659712,
      "total_latency_ms": 0.0,
      "throughput_tps": 120.40349585470135,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.6880096455688459,
      "tokens_per_round": 0.0,
      "total_rounds": 159,
      "avg_path_length": 3.4400482278442297,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 13284028815360,
      "total_flops": 14681403136000,
      "flops_per_token": 26568057630.72,
      "peak_memory_mb": 6749.45849609375,
      "speedup": 0.9078513791944088
    },
    {
      "method": "Tree V2 (D=4, B=2, t=0.03)",
      "config": {
        "tree_depth": 4,
        "branch_factor": 2,
        "probability_threshold": 0.03
      },
      "ttft_ms": 18.629775568842888,
      "tpot_ms": 8.283316173218191,
      "total_latency_ms": 0.0,
      "throughput_tps": 123.69350802537856,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.7256649425484961,
      "tokens_per_round": 0.0,
      "total_rounds": 141,
      "avg_path_length": 3.6283247127424807,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 11780176496640,
      "total_flops": 13177550817280,
      "flops_per_token": 23560352993.28,
      "peak_memory_mb": 6750.04443359375,
      "speedup": 0.9326583174441098
    },
    {
      "method": "Tree V2 (D=5, B=2, t=0.05)",
      "config": {
        "tree_depth": 5,
        "branch_factor": 2,
        "probability_threshold": 0.05
      },
      "ttft_ms": 18.73420150950551,
      "tpot_ms": 8.184001254476607,
      "total_latency_ms": 0.0,
      "throughput_tps": 127.51698205535956,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.6116869675943538,
      "tokens_per_round": 0.0,
      "total_rounds": 146,
      "avg_path_length": 3.670121805566123,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 24837531586560,
      "total_flops": 26234905907200,
      "flops_per_token": 49675063173.12,
      "peak_memory_mb": 6748.59130859375,
      "speedup": 0.9614875980791264
    },
    {
      "method": "Tree V2 (D=7, B=2, t=0.05)",
      "config": {
        "tree_depth": 7,
        "branch_factor": 2,
        "probability_threshold": 0.05
      },
      "ttft_ms": 18.520872108638287,
      "tpot_ms": 8.108967582322657,
      "total_latency_ms": 0.0,
      "throughput_tps": 127.78482931009202,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.48401818167330307,
      "tokens_per_round": 0.0,
      "total_rounds": 140,
      "avg_path_length": 3.8721454533864246,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 97524403200000,
      "total_flops": 98921777520640,
      "flops_per_token": 195048806400.0,
      "peak_memory_mb": 6750.18212890625,
      "speedup": 0.9635071864465252
    },
    {
      "method": "Tree V2 (D=6, B=2, t=0.05)",
      "config": {
        "tree_depth": 6,
        "branch_factor": 2,
        "probability_threshold": 0.05
      },
      "ttft_ms": 18.922787997871637,
      "tpot_ms": 8.977356953173876,
      "total_latency_ms": 0.0,
      "throughput_tps": 120.27026023841954,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.5430245036498939,
      "tokens_per_round": 0.0,
      "total_rounds": 143,
      "avg_path_length": 3.801171525549256,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 49230920161280,
      "total_flops": 50628294481920,
      "flops_per_token": 98461840322.56,
      "peak_memory_mb": 6751.63134765625,
      "speedup": 0.9068467726658307
    },
    {
      "method": "HF Assisted",
      "config": {
        "num_assistant_tokens": 5
      },
      "ttft_ms": 16.45789174363017,
      "tpot_ms": 4.840307399444282,
      "total_latency_ms": 0.0,
      "throughput_tps": 217.00165370328213,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.0,
      "tokens_per_round": 0.0,
      "total_rounds": 0,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 0.0,
      "decode_flops": 0.0,
      "total_flops": 0.0,
      "flops_per_token": 0.0,
      "peak_memory_mb": 5993.3984375,
      "speedup": 1.6362087263623233
    },
    {
      "method": "Linear K=4",
      "config": {
        "K": 4
      },
      "ttft_ms": 18.680070620030165,
      "tpot_ms": 7.814341141469777,
      "total_latency_ms": 0.0,
      "throughput_tps": 131.7274276425576,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.8750392155674869,
      "tokens_per_round": 3.5001568622699475,
      "total_rounds": 147,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 1971188244480,
      "total_flops": 3368562565120,
      "flops_per_token": 3942376488.96,
      "peak_memory_mb": 6300.1689453125,
      "speedup": 0.9932346732468903
    },
    {
      "method": "Linear K=5",
      "config": {
        "K": 5
      },
      "ttft_ms": 18.871559388935566,
      "tpot_ms": 7.4096804613247516,
      "total_latency_ms": 0.0,
      "throughput_tps": 138.76894309264827,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.7884106089510093,
      "tokens_per_round": 3.942053044755047,
      "total_rounds": 130,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 2093161574400,
      "total_flops": 3490535895040,
      "flops_per_token": 4186323148.8,
      "peak_memory_mb": 6300.263671875,
      "speedup": 1.0463282272803875
    },
    {
      "method": "Linear K=6",
      "config": {
        "K": 6
      },
      "ttft_ms": 19.019794836640358,
      "tpot_ms": 7.114662476442755,
      "total_latency_ms": 0.0,
      "throughput_tps": 145.85646189820883,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.7322123888136759,
      "tokens_per_round": 4.393274332882056,
      "total_rounds": 118,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 2217617612800,
      "total_flops": 3614991933440,
      "flops_per_token": 4435235225.6,
      "peak_memory_mb": 6300.35205078125,
      "speedup": 1.0997686500606305
    },
    {
      "method": "Linear K=7",
      "config": {
        "K": 7
      },
      "ttft_ms": 18.80439603701234,
      "tpot_ms": 7.308530408143997,
      "total_latency_ms": 0.0,
      "throughput_tps": 143.93560321019916,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.6597606452510127,
      "tokens_per_round": 4.61832451675709,
      "total_rounds": 114,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 2449383936000,
      "total_flops": 3846758256640,
      "flops_per_token": 4898767872.0,
      "peak_memory_mb": 6301.32666015625,
      "speedup": 1.0852852316451755
    },
    {
      "method": "Streaming K=5 cache=1024",
      "config": {
        "K": 5,
        "max_cache_len": 1024
      },
      "ttft_ms": 17.071922216564417,
      "tpot_ms": 12.039838150702417,
      "total_latency_ms": 0.0,
      "throughput_tps": 90.56174732334509,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.6319568601748677,
      "tokens_per_round": 0.0,
      "total_rounds": 0,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 0.0,
      "decode_flops": 0.0,
      "total_flops": 0.0,
      "flops_per_token": 0.0,
      "peak_memory_mb": 6594.42431640625,
      "speedup": 0.6828423595687826
    },
    {
      "method": "Streaming K=6 cache=512",
      "config": {
        "K": 6,
        "max_cache_len": 512
      },
      "ttft_ms": 16.175219882279634,
      "tpot_ms": 11.814992580190301,
      "total_latency_ms": 0.0,
      "throughput_tps": 93.47844868717407,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.5020769206633631,
      "tokens_per_round": 0.0,
      "total_rounds": 0,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 0.0,
      "decode_flops": 0.0,
      "total_flops": 0.0,
      "flops_per_token": 0.0,
      "peak_memory_mb": 6590.4140625,
      "speedup": 0.7048345063669601
    }
  ],
  "acceptance_comparison": {
    "linear_methods": [
      {
        "method": "Linear K=4",
        "acceptance_rate": 0.8750392155674869,
        "tokens_per_round": 3.5001568622699475,
        "total_rounds": 147
      },
      {
        "method": "Linear K=5",
        "acceptance_rate": 0.7884106089510093,
        "tokens_per_round": 3.942053044755047,
        "total_rounds": 130
      },
      {
        "method": "Linear K=6",
        "acceptance_rate": 0.7322123888136759,
        "tokens_per_round": 4.393274332882056,
        "total_rounds": 118
      },
      {
        "method": "Linear K=7",
        "acceptance_rate": 0.6597606452510127,
        "tokens_per_round": 4.61832451675709,
        "total_rounds": 114
      }
    ],
    "tree_methods": [
      {
        "method": "Tree V2 (D=4, B=2, t=0.05)",
        "acceptance_rate": 0.6880096455688459,
        "avg_path_length": 3.4400482278442297,
        "total_rounds": 159
      },
      {
        "method": "Tree V2 (D=4, B=2, t=0.03)",
        "acceptance_rate": 0.7256649425484961,
        "avg_path_length": 3.6283247127424807,
        "total_rounds": 141
      },
      {
        "method": "Tree V2 (D=5, B=2, t=0.05)",
        "acceptance_rate": 0.6116869675943538,
        "avg_path_length": 3.670121805566123,
        "total_rounds": 146
      },
      {
        "method": "Tree V2 (D=7, B=2, t=0.05)",
        "acceptance_rate": 0.48401818167330307,
        "avg_path_length": 3.8721454533864246,
        "total_rounds": 140
      },
      {
        "method": "Tree V2 (D=6, B=2, t=0.05)",
        "acceptance_rate": 0.5430245036498939,
        "avg_path_length": 3.801171525549256,
        "total_rounds": 143
      }
    ],
    "analysis": {
      "avg_linear_acceptance": 0.7638557146457963,
      "avg_linear_tokens_per_round": 4.1134521891660345,
      "avg_tree_acceptance": 0.6104808482069786,
      "avg_tree_path_length": 3.682362345017703
    }
  },
  "rankings": {
    "by_throughput": [
      {
        "rank": 1,
        "method": "HF Assisted",
        "throughput": 217.00165370328213,
        "speedup": 1.6362087263623233
      },
      {
        "rank": 2,
        "method": "Linear K=6",
        "throughput": 145.85646189820883,
        "speedup": 1.0997686500606305
      },
      {
        "rank": 3,
        "method": "Linear K=7",
        "throughput": 143.93560321019916,
        "speedup": 1.0852852316451755
      },
      {
        "rank": 4,
        "method": "Linear K=5",
        "throughput": 138.76894309264827,
        "speedup": 1.0463282272803875
      },
      {
        "rank": 5,
        "method": "Baseline (AR)",
        "throughput": 132.6246769174296,
        "speedup": 1.0
      },
      {
        "rank": 6,
        "method": "Linear K=4",
        "throughput": 131.7274276425576,
        "speedup": 0.9932346732468903
      },
      {
        "rank": 7,
        "method": "Tree V2 (D=7, B=2, t=0.05)",
        "throughput": 127.78482931009202,
        "speedup": 0.9635071864465252
      },
      {
        "rank": 8,
        "method": "Tree V2 (D=5, B=2, t=0.05)",
        "throughput": 127.51698205535956,
        "speedup": 0.9614875980791264
      },
      {
        "rank": 9,
        "method": "Tree V2 (D=4, B=2, t=0.03)",
        "throughput": 123.69350802537856,
        "speedup": 0.9326583174441098
      },
      {
        "rank": 10,
        "method": "Tree V2 (D=4, B=2, t=0.05)",
        "throughput": 120.40349585470135,
        "speedup": 0.9078513791944088
      },
      {
        "rank": 11,
        "method": "Tree V2 (D=6, B=2, t=0.05)",
        "throughput": 120.27026023841954,
        "speedup": 0.9068467726658307
      },
      {
        "rank": 12,
        "method": "Streaming K=6 cache=512",
        "throughput": 93.47844868717407,
        "speedup": 0.7048345063669601
      },
      {
        "rank": 13,
        "method": "Streaming K=5 cache=1024",
        "throughput": 90.56174732334509,
        "speedup": 0.6828423595687826
      }
    ],
    "by_acceptance_rate": [
      {
        "rank": 1,
        "method": "Linear K=4",
        "acceptance_rate": 0.8750392155674869
      },
      {
        "rank": 2,
        "method": "Linear K=5",
        "acceptance_rate": 0.7884106089510093
      },
      {
        "rank": 3,
        "method": "Linear K=6",
        "acceptance_rate": 0.7322123888136759
      },
      {
        "rank": 4,
        "method": "Tree V2 (D=4, B=2, t=0.03)",
        "acceptance_rate": 0.7256649425484961
      },
      {
        "rank": 5,
        "method": "Tree V2 (D=4, B=2, t=0.05)",
        "acceptance_rate": 0.6880096455688459
      },
      {
        "rank": 6,
        "method": "Linear K=7",
        "acceptance_rate": 0.6597606452510127
      },
      {
        "rank": 7,
        "method": "Streaming K=5 cache=1024",
        "acceptance_rate": 0.6319568601748677
      },
      {
        "rank": 8,
        "method": "Tree V2 (D=5, B=2, t=0.05)",
        "acceptance_rate": 0.6116869675943538
      },
      {
        "rank": 9,
        "method": "Tree V2 (D=6, B=2, t=0.05)",
        "acceptance_rate": 0.5430245036498939
      },
      {
        "rank": 10,
        "method": "Streaming K=6 cache=512",
        "acceptance_rate": 0.5020769206633631
      },
      {
        "rank": 11,
        "method": "Tree V2 (D=7, B=2, t=0.05)",
        "acceptance_rate": 0.48401818167330307
      }
    ]
  },
  "timestamp": "2026-01-03T17:07:35.306559"
}