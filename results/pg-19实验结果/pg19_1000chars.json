{
  "benchmark_info": {
    "target_model": "/mnt/disk1/models/pythia-2.8b",
    "draft_model": "/mnt/disk1/models/pythia-70m",
    "dataset": "PG19 (Project Gutenberg)",
    "data_path": "/mnt/disk1/ljm/LLM-Efficient-Reasoning/data/pg19.parquet",
    "max_new_tokens": 500,
    "num_samples": 10,
    "warmup_runs": 2,
    "max_prompt_length": 1000
  },
  "results": [
    {
      "method": "Baseline (AR)",
      "config": {},
      "ttft_ms": 18.849915638566017,
      "tpot_ms": 8.078022437542677,
      "total_latency_ms": 4057.8611344099045,
      "throughput_tps": 126.38684409011694,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.0,
      "tokens_per_round": 0.0,
      "total_rounds": 0,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 1322762240000,
      "total_flops": 2720136560640,
      "flops_per_token": 2645524480.0,
      "peak_memory_mb": 5866.14404296875,
      "speedup": 1.0
    },
    {
      "method": "Tree V2 (D=4, B=2, t=0.05)",
      "config": {
        "tree_depth": 4,
        "branch_factor": 2,
        "probability_threshold": 0.05
      },
      "ttft_ms": 11.247483920305967,
      "tpot_ms": 7.661169546470046,
      "total_latency_ms": 0.0,
      "throughput_tps": 134.74198147931418,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.8092875734095069,
      "tokens_per_round": 0.0,
      "total_rounds": 125,
      "avg_path_length": 4.046437867047534,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 10443418880000,
      "total_flops": 11840793200640,
      "flops_per_token": 20886837760.0,
      "peak_memory_mb": 5904.296875,
      "speedup": 1.0661076510719725
    },
    {
      "method": "Tree V2 (D=4, B=2, t=0.03)",
      "config": {
        "tree_depth": 4,
        "branch_factor": 2,
        "probability_threshold": 0.03
      },
      "ttft_ms": 10.019705723971128,
      "tpot_ms": 7.074243946745992,
      "total_latency_ms": 0.0,
      "throughput_tps": 143.25836483638477,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.8161809996734863,
      "tokens_per_round": 0.0,
      "total_rounds": 125,
      "avg_path_length": 4.080904998367432,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 10443418880000,
      "total_flops": 11840793200640,
      "flops_per_token": 20886837760.0,
      "peak_memory_mb": 5903.7744140625,
      "speedup": 1.1334911150581308
    },
    {
      "method": "Tree V2 (D=5, B=2, t=0.05)",
      "config": {
        "tree_depth": 5,
        "branch_factor": 2,
        "probability_threshold": 0.05
      },
      "ttft_ms": 9.892401844263077,
      "tpot_ms": 6.764315609633923,
      "total_latency_ms": 0.0,
      "throughput_tps": 150.05410339872265,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.7079632298248568,
      "tokens_per_round": 0.0,
      "total_rounds": 120,
      "avg_path_length": 4.247779378949141,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 20414409523200,
      "total_flops": 21811783843840,
      "flops_per_token": 40828819046.4,
      "peak_memory_mb": 5904.31640625,
      "speedup": 1.1872604659052202
    },
    {
      "method": "Tree V2 (D=7, B=2, t=0.05)",
      "config": {
        "tree_depth": 7,
        "branch_factor": 2,
        "probability_threshold": 0.05
      },
      "ttft_ms": 10.141116939485073,
      "tpot_ms": 6.576713015139103,
      "total_latency_ms": 0.0,
      "throughput_tps": 155.0445505445261,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.5837477298796625,
      "tokens_per_round": 0.0,
      "total_rounds": 111,
      "avg_path_length": 4.6699818390373,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 77322919680000,
      "total_flops": 78720294000640,
      "flops_per_token": 154645839360.0,
      "peak_memory_mb": 5903.837890625,
      "speedup": 1.226745961264572
    },
    {
      "method": "Tree V2 (D=6, B=2, t=0.05)",
      "config": {
        "tree_depth": 6,
        "branch_factor": 2,
        "probability_threshold": 0.05
      },
      "ttft_ms": 11.359429452568293,
      "tpot_ms": 7.548881636932492,
      "total_latency_ms": 0.0,
      "throughput_tps": 140.01720282787855,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.6421131519896811,
      "tokens_per_round": 0.0,
      "total_rounds": 113,
      "avg_path_length": 4.4947920639277665,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 38902755092480,
      "total_flops": 40300129413120,
      "flops_per_token": 77805510184.96,
      "peak_memory_mb": 5903.7841796875,
      "speedup": 1.1078463414122661
    },
    {
      "method": "HF Assisted",
      "config": {
        "num_assistant_tokens": 5
      },
      "ttft_ms": 10.13875724747777,
      "tpot_ms": 5.063948607817292,
      "total_latency_ms": 0.0,
      "throughput_tps": 203.10791721178617,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.0,
      "tokens_per_round": 0.0,
      "total_rounds": 0,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 0.0,
      "decode_flops": 0.0,
      "total_flops": 0.0,
      "flops_per_token": 0.0,
      "peak_memory_mb": 5773.130859375,
      "speedup": 1.6070336962205118
    },
    {
      "method": "Linear K=4",
      "config": {
        "K": 4
      },
      "ttft_ms": 10.032043792307377,
      "tpot_ms": 6.991345455683768,
      "total_latency_ms": 0.0,
      "throughput_tps": 143.9167355436402,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.9401933650422981,
      "tokens_per_round": 3.7607734601691925,
      "total_rounds": 134,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 1796865474560,
      "total_flops": 3194239795200,
      "flops_per_token": 3593730949.12,
      "peak_memory_mb": 5846.443359375,
      "speedup": 1.1387002862499203
    },
    {
      "method": "Linear K=5",
      "config": {
        "K": 5
      },
      "ttft_ms": 9.947159327566624,
      "tpot_ms": 6.874303554184735,
      "total_latency_ms": 0.0,
      "throughput_tps": 147.0881228047198,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.824961896770201,
      "tokens_per_round": 4.1248094838510045,
      "total_rounds": 122,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 1964351631360,
      "total_flops": 3361725952000,
      "flops_per_token": 3928703262.72,
      "peak_memory_mb": 5844.66796875,
      "speedup": 1.1637929870283203
    },
    {
      "method": "Linear K=6",
      "config": {
        "K": 6
      },
      "ttft_ms": 10.038436856120825,
      "tpot_ms": 6.661272871866823,
      "total_latency_ms": 0.0,
      "throughput_tps": 153.38734928646528,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.7612986194301066,
      "tokens_per_round": 4.567791716580639,
      "total_rounds": 112,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 2104857395200,
      "total_flops": 3502231715840,
      "flops_per_token": 4209714790.4,
      "peak_memory_mb": 5847.23779296875,
      "speedup": 1.2136338270864357
    },
    {
      "method": "Linear K=7",
      "config": {
        "K": 7
      },
      "ttft_ms": 10.113065969198942,
      "tpot_ms": 6.756583618558944,
      "total_latency_ms": 0.0,
      "throughput_tps": 152.81394298072976,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.6866048976736924,
      "tokens_per_round": 4.806234283715847,
      "total_rounds": 107,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 2298983168000,
      "total_flops": 3696357488640,
      "flops_per_token": 4597966336.0,
      "peak_memory_mb": 5846.3046875,
      "speedup": 1.2090969125850604
    },
    {
      "method": "Streaming K=5 cache=1024",
      "config": {
        "K": 5,
        "max_cache_len": 1024
      },
      "ttft_ms": 10.542322136461735,
      "tpot_ms": 7.32318628244102,
      "total_latency_ms": 0.0,
      "throughput_tps": 140.40517095736047,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.824961896770201,
      "tokens_per_round": 0.0,
      "total_rounds": 0,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 0.0,
      "decode_flops": 0.0,
      "total_flops": 0.0,
      "flops_per_token": 0.0,
      "peak_memory_mb": 5844.66796875,
      "speedup": 1.1109160290231483
    },
    {
      "method": "Streaming K=6 cache=512",
      "config": {
        "K": 6,
        "max_cache_len": 512
      },
      "ttft_ms": 10.447083041071892,
      "tpot_ms": 6.722377503849566,
      "total_latency_ms": 0.0,
      "throughput_tps": 151.23152174505753,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.7612986194301066,
      "tokens_per_round": 0.0,
      "total_rounds": 0,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 0.0,
      "decode_flops": 0.0,
      "total_flops": 0.0,
      "flops_per_token": 0.0,
      "peak_memory_mb": 5847.23779296875,
      "speedup": 1.196576454090631
    }
  ],
  "acceptance_comparison": {
    "linear_methods": [
      {
        "method": "Linear K=4",
        "acceptance_rate": 0.9401933650422981,
        "tokens_per_round": 3.7607734601691925,
        "total_rounds": 134
      },
      {
        "method": "Linear K=5",
        "acceptance_rate": 0.824961896770201,
        "tokens_per_round": 4.1248094838510045,
        "total_rounds": 122
      },
      {
        "method": "Linear K=6",
        "acceptance_rate": 0.7612986194301066,
        "tokens_per_round": 4.567791716580639,
        "total_rounds": 112
      },
      {
        "method": "Linear K=7",
        "acceptance_rate": 0.6866048976736924,
        "tokens_per_round": 4.806234283715847,
        "total_rounds": 107
      }
    ],
    "tree_methods": [
      {
        "method": "Tree V2 (D=4, B=2, t=0.05)",
        "acceptance_rate": 0.8092875734095069,
        "avg_path_length": 4.046437867047534,
        "total_rounds": 125
      },
      {
        "method": "Tree V2 (D=4, B=2, t=0.03)",
        "acceptance_rate": 0.8161809996734863,
        "avg_path_length": 4.080904998367432,
        "total_rounds": 125
      },
      {
        "method": "Tree V2 (D=5, B=2, t=0.05)",
        "acceptance_rate": 0.7079632298248568,
        "avg_path_length": 4.247779378949141,
        "total_rounds": 120
      },
      {
        "method": "Tree V2 (D=7, B=2, t=0.05)",
        "acceptance_rate": 0.5837477298796625,
        "avg_path_length": 4.6699818390373,
        "total_rounds": 111
      },
      {
        "method": "Tree V2 (D=6, B=2, t=0.05)",
        "acceptance_rate": 0.6421131519896811,
        "avg_path_length": 4.4947920639277665,
        "total_rounds": 113
      }
    ],
    "analysis": {
      "avg_linear_acceptance": 0.8032646947290746,
      "avg_linear_tokens_per_round": 4.3149022360791705,
      "avg_tree_acceptance": 0.7118585369554388,
      "avg_tree_path_length": 4.307979229465834
    }
  },
  "rankings": {
    "by_throughput": [
      {
        "rank": 1,
        "method": "HF Assisted",
        "throughput": 203.10791721178617,
        "speedup": 1.6070336962205118
      },
      {
        "rank": 2,
        "method": "Tree V2 (D=7, B=2, t=0.05)",
        "throughput": 155.0445505445261,
        "speedup": 1.226745961264572
      },
      {
        "rank": 3,
        "method": "Linear K=6",
        "throughput": 153.38734928646528,
        "speedup": 1.2136338270864357
      },
      {
        "rank": 4,
        "method": "Linear K=7",
        "throughput": 152.81394298072976,
        "speedup": 1.2090969125850604
      },
      {
        "rank": 5,
        "method": "Streaming K=6 cache=512",
        "throughput": 151.23152174505753,
        "speedup": 1.196576454090631
      },
      {
        "rank": 6,
        "method": "Tree V2 (D=5, B=2, t=0.05)",
        "throughput": 150.05410339872265,
        "speedup": 1.1872604659052202
      },
      {
        "rank": 7,
        "method": "Linear K=5",
        "throughput": 147.0881228047198,
        "speedup": 1.1637929870283203
      },
      {
        "rank": 8,
        "method": "Linear K=4",
        "throughput": 143.9167355436402,
        "speedup": 1.1387002862499203
      },
      {
        "rank": 9,
        "method": "Tree V2 (D=4, B=2, t=0.03)",
        "throughput": 143.25836483638477,
        "speedup": 1.1334911150581308
      },
      {
        "rank": 10,
        "method": "Streaming K=5 cache=1024",
        "throughput": 140.40517095736047,
        "speedup": 1.1109160290231483
      },
      {
        "rank": 11,
        "method": "Tree V2 (D=6, B=2, t=0.05)",
        "throughput": 140.01720282787855,
        "speedup": 1.1078463414122661
      },
      {
        "rank": 12,
        "method": "Tree V2 (D=4, B=2, t=0.05)",
        "throughput": 134.74198147931418,
        "speedup": 1.0661076510719725
      },
      {
        "rank": 13,
        "method": "Baseline (AR)",
        "throughput": 126.38684409011694,
        "speedup": 1.0
      }
    ],
    "by_acceptance_rate": [
      {
        "rank": 1,
        "method": "Linear K=4",
        "acceptance_rate": 0.9401933650422981
      },
      {
        "rank": 2,
        "method": "Linear K=5",
        "acceptance_rate": 0.824961896770201
      },
      {
        "rank": 3,
        "method": "Streaming K=5 cache=1024",
        "acceptance_rate": 0.824961896770201
      },
      {
        "rank": 4,
        "method": "Tree V2 (D=4, B=2, t=0.03)",
        "acceptance_rate": 0.8161809996734863
      },
      {
        "rank": 5,
        "method": "Tree V2 (D=4, B=2, t=0.05)",
        "acceptance_rate": 0.8092875734095069
      },
      {
        "rank": 6,
        "method": "Linear K=6",
        "acceptance_rate": 0.7612986194301066
      },
      {
        "rank": 7,
        "method": "Streaming K=6 cache=512",
        "acceptance_rate": 0.7612986194301066
      },
      {
        "rank": 8,
        "method": "Tree V2 (D=5, B=2, t=0.05)",
        "acceptance_rate": 0.7079632298248568
      },
      {
        "rank": 9,
        "method": "Linear K=7",
        "acceptance_rate": 0.6866048976736924
      },
      {
        "rank": 10,
        "method": "Tree V2 (D=6, B=2, t=0.05)",
        "acceptance_rate": 0.6421131519896811
      },
      {
        "rank": 11,
        "method": "Tree V2 (D=7, B=2, t=0.05)",
        "acceptance_rate": 0.5837477298796625
      }
    ]
  },
  "timestamp": "2026-01-03T17:04:36.431920"
}