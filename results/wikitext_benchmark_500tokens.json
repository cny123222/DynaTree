{
  "benchmark_info": {
    "target_model": "/mnt/disk1/models/pythia-2.8b",
    "draft_model": "/mnt/disk1/models/pythia-70m",
    "dataset": "WikiText-2 (ModelScope)",
    "max_new_tokens": 500,
    "num_samples": 5,
    "warmup_runs": 3,
    "max_prompt_length": 800
  },
  "results": [
    {
      "method": "Baseline (AR)",
      "config": {},
      "ttft_ms": 15.496914461255074,
      "tpot_ms": 7.548235516622663,
      "total_latency_ms": 3789.6146727725863,
      "throughput_tps": 131.94240031086318,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.0,
      "tokens_per_round": 0.0,
      "total_rounds": 0,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 1322762240000,
      "total_flops": 2720136560640,
      "flops_per_token": 2645524480.0,
      "peak_memory_mb": 5785.77392578125,
      "speedup": 1.0
    },
    {
      "method": "Tree V2 (D=4, B=2, t=0.05)",
      "config": {
        "tree_depth": 4,
        "branch_factor": 2,
        "probability_threshold": 0.05
      },
      "ttft_ms": 11.953884921967983,
      "tpot_ms": 5.774332606419921,
      "total_latency_ms": 0.0,
      "throughput_tps": 173.99639541142182,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.9691849312075471,
      "tokens_per_round": 0.0,
      "total_rounds": 104,
      "avg_path_length": 4.8459246560377345,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 8688924508160,
      "total_flops": 10086298828800,
      "flops_per_token": 17377849016.32,
      "peak_memory_mb": 5809.1806640625,
      "speedup": 1.3187299533847894
    },
    {
      "method": "Tree V2 (D=4, B=2, t=0.03)",
      "config": {
        "tree_depth": 4,
        "branch_factor": 2,
        "probability_threshold": 0.03
      },
      "ttft_ms": 11.769772320985794,
      "tpot_ms": 5.71053408831358,
      "total_latency_ms": 0.0,
      "throughput_tps": 176.70736975603555,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.9691847952005389,
      "tokens_per_round": 0.0,
      "total_rounds": 104,
      "avg_path_length": 4.845923976002695,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 8688924508160,
      "total_flops": 10086298828800,
      "flops_per_token": 17377849016.32,
      "peak_memory_mb": 5811.1611328125,
      "speedup": 1.339276603576286
    },
    {
      "method": "Tree V2 (D=5, B=2, t=0.05)",
      "config": {
        "tree_depth": 5,
        "branch_factor": 2,
        "probability_threshold": 0.05
      },
      "ttft_ms": 11.947477050125599,
      "tpot_ms": 5.525710349529982,
      "total_latency_ms": 0.0,
      "throughput_tps": 182.7709625502689,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.8894529727863061,
      "tokens_per_round": 0.0,
      "total_rounds": 95,
      "avg_path_length": 5.3367178367178365,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 16161407539200,
      "total_flops": 17558781859840,
      "flops_per_token": 32322815078.4,
      "peak_memory_mb": 5810.54296875,
      "speedup": 1.385232966200789
    },
    {
      "method": "Tree V2 (D=7, B=2, t=0.05)",
      "config": {
        "tree_depth": 7,
        "branch_factor": 2,
        "probability_threshold": 0.05
      },
      "ttft_ms": 11.992264911532402,
      "tpot_ms": 5.4624207213521005,
      "total_latency_ms": 0.0,
      "throughput_tps": 186.8314596368054,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.7582343277256296,
      "tokens_per_round": 0.0,
      "total_rounds": 85,
      "avg_path_length": 6.065874621805037,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 59211244800000,
      "total_flops": 60608619120640,
      "flops_per_token": 118422489600.0,
      "peak_memory_mb": 5811.2265625,
      "speedup": 1.4160077366837402
    },
    {
      "method": "Tree V2 (D=6, B=2, t=0.05)",
      "config": {
        "tree_depth": 6,
        "branch_factor": 2,
        "probability_threshold": 0.05
      },
      "ttft_ms": 12.010163255035877,
      "tpot_ms": 5.41127377524972,
      "total_latency_ms": 0.0,
      "throughput_tps": 187.2782238354379,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.8219180108527029,
      "tokens_per_round": 0.0,
      "total_rounds": 89,
      "avg_path_length": 5.75342607596892,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 30640223037440,
      "total_flops": 32037597358080,
      "flops_per_token": 61280446074.88,
      "peak_memory_mb": 5809.4931640625,
      "speedup": 1.4193937914893213
    },
    {
      "method": "HF Assisted",
      "config": {
        "num_assistant_tokens": 5
      },
      "ttft_ms": 12.030455842614174,
      "tpot_ms": 4.405852828919888,
      "total_latency_ms": 0.0,
      "throughput_tps": 240.29455377678443,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.0,
      "tokens_per_round": 0.0,
      "total_rounds": 0,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 0.0,
      "decode_flops": 0.0,
      "total_flops": 0.0,
      "flops_per_token": 0.0,
      "peak_memory_mb": 5718.3623046875,
      "speedup": 1.8212079908402297
    },
    {
      "method": "Linear K=4",
      "config": {
        "K": 4
      },
      "ttft_ms": 11.937432177364826,
      "tpot_ms": 6.252495506033301,
      "total_latency_ms": 0.0,
      "throughput_tps": 161.4676864553167,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 1.041006363809548,
      "tokens_per_round": 4.164025455238192,
      "total_rounds": 121,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 1622542704640,
      "total_flops": 3019917025280,
      "flops_per_token": 3245085409.28,
      "peak_memory_mb": 5773.0947265625,
      "speedup": 1.2237740565192874
    },
    {
      "method": "Linear K=5",
      "config": {
        "K": 5
      },
      "ttft_ms": 11.869177408516407,
      "tpot_ms": 6.20529688745737,
      "total_latency_ms": 0.0,
      "throughput_tps": 164.30821662746987,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.9064549983495768,
      "tokens_per_round": 4.532274991747883,
      "total_rounds": 112,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 1803339202560,
      "total_flops": 3200713523200,
      "flops_per_token": 3606678405.12,
      "peak_memory_mb": 5772.798828125,
      "speedup": 1.2453026187211325
    },
    {
      "method": "Linear K=6",
      "config": {
        "K": 6
      },
      "ttft_ms": 11.87397874891758,
      "tpot_ms": 5.41707903854549,
      "total_latency_ms": 0.0,
      "throughput_tps": 187.16805488658028,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.9195011939680369,
      "tokens_per_round": 5.517007163808221,
      "total_rounds": 92,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 1728990003200,
      "total_flops": 3126364323840,
      "flops_per_token": 3457980006.4,
      "peak_memory_mb": 5771.3623046875,
      "speedup": 1.4185588138885041
    },
    {
      "method": "Linear K=7",
      "config": {
        "K": 7
      },
      "ttft_ms": 11.925952322781086,
      "tpot_ms": 5.186295596882701,
      "total_latency_ms": 0.0,
      "throughput_tps": 197.6018890855848,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.8745810021788134,
      "tokens_per_round": 6.122067015251695,
      "total_rounds": 84,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 1804809216000,
      "total_flops": 3202183536640,
      "flops_per_token": 3609618432.0,
      "peak_memory_mb": 5774.359375,
      "speedup": 1.4976375192510099
    },
    {
      "method": "Streaming K=5 cache=1024",
      "config": {
        "K": 5,
        "max_cache_len": 1024
      },
      "ttft_ms": 12.022176012396812,
      "tpot_ms": 6.217733247578144,
      "total_latency_ms": 0.0,
      "throughput_tps": 164.00439997976986,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.9064549983495768,
      "tokens_per_round": 0.0,
      "total_rounds": 0,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 0.0,
      "decode_flops": 0.0,
      "total_flops": 0.0,
      "flops_per_token": 0.0,
      "peak_memory_mb": 5772.798828125,
      "speedup": 1.2429999726650942
    },
    {
      "method": "Streaming K=6 cache=512",
      "config": {
        "K": 6,
        "max_cache_len": 512
      },
      "ttft_ms": 11.915011890232563,
      "tpot_ms": 5.381611278280616,
      "total_latency_ms": 0.0,
      "throughput_tps": 188.35688699155648,
      "total_tokens_generated": 500,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.9195011939680369,
      "tokens_per_round": 0.0,
      "total_rounds": 0,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 0.0,
      "decode_flops": 0.0,
      "total_flops": 0.0,
      "flops_per_token": 0.0,
      "peak_memory_mb": 5771.3623046875,
      "speedup": 1.4275690494320084
    }
  ],
  "acceptance_comparison": {
    "linear_methods": [
      {
        "method": "Linear K=4",
        "acceptance_rate": 1.041006363809548,
        "tokens_per_round": 4.164025455238192,
        "total_rounds": 121
      },
      {
        "method": "Linear K=5",
        "acceptance_rate": 0.9064549983495768,
        "tokens_per_round": 4.532274991747883,
        "total_rounds": 112
      },
      {
        "method": "Linear K=6",
        "acceptance_rate": 0.9195011939680369,
        "tokens_per_round": 5.517007163808221,
        "total_rounds": 92
      },
      {
        "method": "Linear K=7",
        "acceptance_rate": 0.8745810021788134,
        "tokens_per_round": 6.122067015251695,
        "total_rounds": 84
      }
    ],
    "tree_methods": [
      {
        "method": "Tree V2 (D=4, B=2, t=0.05)",
        "acceptance_rate": 0.9691849312075471,
        "avg_path_length": 4.8459246560377345,
        "total_rounds": 104
      },
      {
        "method": "Tree V2 (D=4, B=2, t=0.03)",
        "acceptance_rate": 0.9691847952005389,
        "avg_path_length": 4.845923976002695,
        "total_rounds": 104
      },
      {
        "method": "Tree V2 (D=5, B=2, t=0.05)",
        "acceptance_rate": 0.8894529727863061,
        "avg_path_length": 5.3367178367178365,
        "total_rounds": 95
      },
      {
        "method": "Tree V2 (D=7, B=2, t=0.05)",
        "acceptance_rate": 0.7582343277256296,
        "avg_path_length": 6.065874621805037,
        "total_rounds": 85
      },
      {
        "method": "Tree V2 (D=6, B=2, t=0.05)",
        "acceptance_rate": 0.8219180108527029,
        "avg_path_length": 5.75342607596892,
        "total_rounds": 89
      }
    ],
    "analysis": {
      "avg_linear_acceptance": 0.9353858895764937,
      "avg_linear_tokens_per_round": 5.0838436565114975,
      "avg_tree_acceptance": 0.8815950075545448,
      "avg_tree_path_length": 5.369573433306444
    }
  },
  "rankings": {
    "by_throughput": [
      {
        "rank": 1,
        "method": "HF Assisted",
        "throughput": 240.29455377678443,
        "speedup": 1.8212079908402297
      },
      {
        "rank": 2,
        "method": "Linear K=7",
        "throughput": 197.6018890855848,
        "speedup": 1.4976375192510099
      },
      {
        "rank": 3,
        "method": "Streaming K=6 cache=512",
        "throughput": 188.35688699155648,
        "speedup": 1.4275690494320084
      },
      {
        "rank": 4,
        "method": "Tree V2 (D=6, B=2, t=0.05)",
        "throughput": 187.2782238354379,
        "speedup": 1.4193937914893213
      },
      {
        "rank": 5,
        "method": "Linear K=6",
        "throughput": 187.16805488658028,
        "speedup": 1.4185588138885041
      },
      {
        "rank": 6,
        "method": "Tree V2 (D=7, B=2, t=0.05)",
        "throughput": 186.8314596368054,
        "speedup": 1.4160077366837402
      },
      {
        "rank": 7,
        "method": "Tree V2 (D=5, B=2, t=0.05)",
        "throughput": 182.7709625502689,
        "speedup": 1.385232966200789
      },
      {
        "rank": 8,
        "method": "Tree V2 (D=4, B=2, t=0.03)",
        "throughput": 176.70736975603555,
        "speedup": 1.339276603576286
      },
      {
        "rank": 9,
        "method": "Tree V2 (D=4, B=2, t=0.05)",
        "throughput": 173.99639541142182,
        "speedup": 1.3187299533847894
      },
      {
        "rank": 10,
        "method": "Linear K=5",
        "throughput": 164.30821662746987,
        "speedup": 1.2453026187211325
      },
      {
        "rank": 11,
        "method": "Streaming K=5 cache=1024",
        "throughput": 164.00439997976986,
        "speedup": 1.2429999726650942
      },
      {
        "rank": 12,
        "method": "Linear K=4",
        "throughput": 161.4676864553167,
        "speedup": 1.2237740565192874
      },
      {
        "rank": 13,
        "method": "Baseline (AR)",
        "throughput": 131.94240031086318,
        "speedup": 1.0
      }
    ],
    "by_acceptance_rate": [
      {
        "rank": 1,
        "method": "Linear K=4",
        "acceptance_rate": 1.041006363809548
      },
      {
        "rank": 2,
        "method": "Tree V2 (D=4, B=2, t=0.05)",
        "acceptance_rate": 0.9691849312075471
      },
      {
        "rank": 3,
        "method": "Tree V2 (D=4, B=2, t=0.03)",
        "acceptance_rate": 0.9691847952005389
      },
      {
        "rank": 4,
        "method": "Linear K=6",
        "acceptance_rate": 0.9195011939680369
      },
      {
        "rank": 5,
        "method": "Streaming K=6 cache=512",
        "acceptance_rate": 0.9195011939680369
      },
      {
        "rank": 6,
        "method": "Linear K=5",
        "acceptance_rate": 0.9064549983495768
      },
      {
        "rank": 7,
        "method": "Streaming K=5 cache=1024",
        "acceptance_rate": 0.9064549983495768
      },
      {
        "rank": 8,
        "method": "Tree V2 (D=5, B=2, t=0.05)",
        "acceptance_rate": 0.8894529727863061
      },
      {
        "rank": 9,
        "method": "Linear K=7",
        "acceptance_rate": 0.8745810021788134
      },
      {
        "rank": 10,
        "method": "Tree V2 (D=6, B=2, t=0.05)",
        "acceptance_rate": 0.8219180108527029
      },
      {
        "rank": 11,
        "method": "Tree V2 (D=7, B=2, t=0.05)",
        "acceptance_rate": 0.7582343277256296
      }
    ]
  },
  "timestamp": "2026-01-03T16:03:57.364795"
}