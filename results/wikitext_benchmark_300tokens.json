
{
  "benchmark_info": {
    "target_model": "/mnt/disk1/models/pythia-2.8b",
    "draft_model": "/mnt/disk1/models/pythia-70m",
    "dataset": "WikiText-2 (ModelScope)",
    "max_new_tokens": 300,
    "num_samples": 5,
    "warmup_runs": 3,
    "max_prompt_length": 800
  },
  "results": [
    {
      "method": "Baseline (AR)",
      "config": {},
      "ttft_ms": 23.383482545614243,
      "tpot_ms": 9.977032030622166,
      "total_latency_ms": 3016.493091732264,
      "throughput_tps": 106.1524242485453,
      "total_tokens_generated": 300,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.0,
      "tokens_per_round": 0.0,
      "total_rounds": 0,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 793657344000,
      "total_flops": 2191031664640,
      "flops_per_token": 2645524480.0,
      "peak_memory_mb": 5723.71240234375,
      "speedup": 1.0
    },
    {
      "method": "Tree V2 (D=4, B=2, t=0.05)",
      "config": {
        "tree_depth": 4,
        "branch_factor": 2,
        "probability_threshold": 0.05
      },
      "ttft_ms": 12.09636926651001,
      "tpot_ms": 6.352299379805724,
      "total_latency_ms": 0.0,
      "throughput_tps": 159.3284599283284,
      "total_tokens_generated": 300,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.8737018213238885,
      "tokens_per_round": 0.0,
      "total_rounds": 70,
      "avg_path_length": 4.368509106619442,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 5848314572800,
      "total_flops": 7245688893440,
      "flops_per_token": 19494381909.333332,
      "peak_memory_mb": 5745.7724609375,
      "speedup": 1.5009403794234293
    },
    {
      "method": "Tree V2 (D=4, B=2, t=0.03)",
      "config": {
        "tree_depth": 4,
        "branch_factor": 2,
        "probability_threshold": 0.03
      },
      "ttft_ms": 12.110612541437149,
      "tpot_ms": 6.344360510508219,
      "total_latency_ms": 0.0,
      "throughput_tps": 160.93679193531568,
      "total_tokens_generated": 300,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.8742486429233416,
      "tokens_per_round": 0.0,
      "total_rounds": 70,
      "avg_path_length": 4.371243214616708,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 5848314572800,
      "total_flops": 7245688893440,
      "flops_per_token": 19494381909.333332,
      "peak_memory_mb": 5746.6904296875,
      "speedup": 1.5160915360585479
    },
    {
      "method": "Tree V2 (D=5, B=2, t=0.05)",
      "config": {
        "tree_depth": 5,
        "branch_factor": 2,
        "probability_threshold": 0.05
      },
      "ttft_ms": 12.052133493125439,
      "tpot_ms": 6.150090541069706,
      "total_latency_ms": 0.0,
      "throughput_tps": 166.5249502506026,
      "total_tokens_generated": 300,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.7888351841509491,
      "tokens_per_round": 0.0,
      "total_rounds": 66,
      "avg_path_length": 4.733011104905695,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 11227925237760,
      "total_flops": 12625299558400,
      "flops_per_token": 37426417459.2,
      "peak_memory_mb": 5747.3701171875,
      "speedup": 1.5687343122819413
    },
    {
      "method": "Tree V2 (D=7, B=2, t=0.05)",
      "config": {
        "tree_depth": 7,
        "branch_factor": 2,
        "probability_threshold": 0.05
      },
      "ttft_ms": 12.06628605723381,
      "tpot_ms": 6.200186990822354,
      "total_latency_ms": 0.0,
      "throughput_tps": 166.8358527613434,
      "total_tokens_generated": 300,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.6490049577819497,
      "tokens_per_round": 0.0,
      "total_rounds": 62,
      "avg_path_length": 5.192039662255597,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 43189378560000,
      "total_flops": 44586752880640,
      "flops_per_token": 143964595200.0,
      "peak_memory_mb": 5748.375,
      "speedup": 1.5716631432807782
    },
    {
      "method": "Tree V2 (D=6, B=2, t=0.05)",
      "config": {
        "tree_depth": 6,
        "branch_factor": 2,
        "probability_threshold": 0.05
      },
      "ttft_ms": 12.052211724221706,
      "tpot_ms": 6.228770598769188,
      "total_latency_ms": 0.0,
      "throughput_tps": 165.51398151997213,
      "total_tokens_generated": 300,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.7057240674774234,
      "tokens_per_round": 0.0,
      "total_rounds": 64,
      "avg_path_length": 4.940068472341965,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 22033418813440,
      "total_flops": 23430793134080,
      "flops_per_token": 73444729378.13333,
      "peak_memory_mb": 5747.2783203125,
      "speedup": 1.5592105662366944
    },
    {
      "method": "HF Assisted",
      "config": {
        "num_assistant_tokens": 5
      },
      "ttft_ms": 12.076758965849876,
      "tpot_ms": 4.855196472257376,
      "total_latency_ms": 0.0,
      "throughput_tps": 218.16332552154373,
      "total_tokens_generated": 300,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.0,
      "tokens_per_round": 0.0,
      "total_rounds": 0,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 0.0,
      "decode_flops": 0.0,
      "total_flops": 0.0,
      "flops_per_token": 0.0,
      "peak_memory_mb": 5652.716796875,
      "speedup": 2.055189290926942
    },
    {
      "method": "Linear K=4",
      "config": {
        "K": 4
      },
      "ttft_ms": 12.071196548640728,
      "tpot_ms": 6.837324456622203,
      "total_latency_ms": 0.0,
      "throughput_tps": 149.23812734877924,
      "total_tokens_generated": 300,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.963949123785618,
      "tokens_per_round": 3.855796495142472,
      "total_rounds": 79,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 1059346063360,
      "total_flops": 2456720384000,
      "flops_per_token": 3531153544.5333333,
      "peak_memory_mb": 5692.2939453125,
      "speedup": 1.4058852485493225
    },
    {
      "method": "Linear K=5",
      "config": {
        "K": 5
      },
      "ttft_ms": 12.105015106499195,
      "tpot_ms": 6.919026080518961,
      "total_latency_ms": 0.0,
      "throughput_tps": 148.47824192552346,
      "total_tokens_generated": 300,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.8260349456896403,
      "tokens_per_round": 4.1301747284482015,
      "total_rounds": 75,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 1207593216000,
      "total_flops": 2604967536640,
      "flops_per_token": 4025310720.0,
      "peak_memory_mb": 5692.82177734375,
      "speedup": 1.3987268117200649
    },
    {
      "method": "Linear K=6",
      "config": {
        "K": 6
      },
      "ttft_ms": 12.013647146522999,
      "tpot_ms": 6.05336639843881,
      "total_latency_ms": 0.0,
      "throughput_tps": 169.4734838770487,
      "total_tokens_generated": 300,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.8243212760916794,
      "tokens_per_round": 4.945927656550077,
      "total_rounds": 62,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 1165188915200,
      "total_flops": 2562563235840,
      "flops_per_token": 3883963050.6666665,
      "peak_memory_mb": 5693.7216796875,
      "speedup": 1.596510725748886
    },
    {
      "method": "Linear K=7",
      "config": {
        "K": 7
      },
      "ttft_ms": 11.95051223039627,
      "tpot_ms": 5.898721820985278,
      "total_latency_ms": 0.0,
      "throughput_tps": 176.27794547985417,
      "total_tokens_generated": 300,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.7770710015172239,
      "tokens_per_round": 5.439497010620567,
      "total_rounds": 57,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 1397374320640,
      "decode_flops": 1224691968000,
      "total_flops": 2622066288640,
      "flops_per_token": 4082306560.0,
      "peak_memory_mb": 5693.7734375,
      "speedup": 1.6606115849706546
    },
    {
      "method": "Streaming K=5 cache=1024",
      "config": {
        "K": 5,
        "max_cache_len": 1024
      },
      "ttft_ms": 12.056958302855492,
      "tpot_ms": 6.874117252727349,
      "total_latency_ms": 0.0,
      "throughput_tps": 149.41879542384592,
      "total_tokens_generated": 300,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.8260349456896403,
      "tokens_per_round": 0.0,
      "total_rounds": 0,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 0.0,
      "decode_flops": 0.0,
      "total_flops": 0.0,
      "flops_per_token": 0.0,
      "peak_memory_mb": 5692.82177734375,
      "speedup": 1.4075872169814674
    },
    {
      "method": "Streaming K=6 cache=512",
      "config": {
        "K": 6,
        "max_cache_len": 512
      },
      "ttft_ms": 12.036710418760777,
      "tpot_ms": 6.059648305177689,
      "total_latency_ms": 0.0,
      "throughput_tps": 169.33043518571475,
      "total_tokens_generated": 300,
      "prompt_tokens": 0,
      "total_draft_tokens": 0,
      "total_accepted_tokens": 0,
      "acceptance_rate": 0.8243212760916794,
      "tokens_per_round": 0.0,
      "total_rounds": 0,
      "avg_path_length": 0.0,
      "max_path_length": 0,
      "prefill_flops": 0.0,
      "decode_flops": 0.0,
      "total_flops": 0.0,
      "flops_per_token": 0.0,
      "peak_memory_mb": 5693.7216796875,
      "speedup": 1.5951631475626449
    }
  ],
  "acceptance_comparison": {
    "linear_methods": [
      {
        "method": "Linear K=4",
        "acceptance_rate": 0.963949123785618,
        "tokens_per_round": 3.855796495142472,
        "total_rounds": 79
      },
      {
        "method": "Linear K=5",
        "acceptance_rate": 0.8260349456896403,
        "tokens_per_round": 4.1301747284482015,
        "total_rounds": 75
      },
      {
        "method": "Linear K=6",
        "acceptance_rate": 0.8243212760916794,
        "tokens_per_round": 4.945927656550077,
        "total_rounds": 62
      },
      {
        "method": "Linear K=7",
        "acceptance_rate": 0.7770710015172239,
        "tokens_per_round": 5.439497010620567,
        "total_rounds": 57
      }
    ],
    "tree_methods": [
      {
        "method": "Tree V2 (D=4, B=2, t=0.05)",
        "acceptance_rate": 0.8737018213238885,
        "avg_path_length": 4.368509106619442,
        "total_rounds": 70
      },
      {
        "method": "Tree V2 (D=4, B=2, t=0.03)",
        "acceptance_rate": 0.8742486429233416,
        "avg_path_length": 4.371243214616708,
        "total_rounds": 70
      },
      {
        "method": "Tree V2 (D=5, B=2, t=0.05)",
        "acceptance_rate": 0.7888351841509491,
        "avg_path_length": 4.733011104905695,
        "total_rounds": 66
      },
      {
        "method": "Tree V2 (D=7, B=2, t=0.05)",
        "acceptance_rate": 0.6490049577819497,
        "avg_path_length": 5.192039662255597,
        "total_rounds": 62
      },
      {
        "method": "Tree V2 (D=6, B=2, t=0.05)",
        "acceptance_rate": 0.7057240674774234,
        "avg_path_length": 4.940068472341965,
        "total_rounds": 64
      }
    ],
    "analysis": {
      "avg_linear_acceptance": 0.8478440867710404,
      "avg_linear_tokens_per_round": 4.592848972690329,
      "avg_tree_acceptance": 0.7783029347315106,
      "avg_tree_path_length": 4.720974312147881
    }
  },
  "rankings": {
    "by_throughput": [
      {
        "rank": 1,
        "method": "HF Assisted",
        "throughput": 218.16332552154373,
        "speedup": 2.055189290926942
      },
      {
        "rank": 2,
        "method": "Linear K=7",
        "throughput": 176.27794547985417,
        "speedup": 1.6606115849706546
      },
      {
        "rank": 3,
        "method": "Linear K=6",
        "throughput": 169.4734838770487,
        "speedup": 1.596510725748886
      },
      {
        "rank": 4,
        "method": "Streaming K=6 cache=512",
        "throughput": 169.33043518571475,
        "speedup": 1.5951631475626449
      },
      {
        "rank": 5,
        "method": "Tree V2 (D=7, B=2, t=0.05)",
        "throughput": 166.8358527613434,
        "speedup": 1.5716631432807782
      },
      {
        "rank": 6,
        "method": "Tree V2 (D=5, B=2, t=0.05)",
        "throughput": 166.5249502506026,
        "speedup": 1.5687343122819413
      },
      {
        "rank": 7,
        "method": "Tree V2 (D=6, B=2, t=0.05)",
        "throughput": 165.51398151997213,
        "speedup": 1.5592105662366944
      },
      {
        "rank": 8,
        "method": "Tree V2 (D=4, B=2, t=0.03)",
        "throughput": 160.93679193531568,
        "speedup": 1.5160915360585479
      },
      {
        "rank": 9,
        "method": "Tree V2 (D=4, B=2, t=0.05)",
        "throughput": 159.3284599283284,
        "speedup": 1.5009403794234293
      },
      {
        "rank": 10,
        "method": "Streaming K=5 cache=1024",
        "throughput": 149.41879542384592,
        "speedup": 1.4075872169814674
      },
      {
        "rank": 11,
        "method": "Linear K=4",
        "throughput": 149.23812734877924,
        "speedup": 1.4058852485493225
      },
      {
        "rank": 12,
        "method": "Linear K=5",
        "throughput": 148.47824192552346,
        "speedup": 1.3987268117200649
      },
      {
        "rank": 13,
        "method": "Baseline (AR)",
        "throughput": 106.1524242485453,
        "speedup": 1.0
      }
    ],
    "by_acceptance_rate": [
      {
        "rank": 1,
        "method": "Linear K=4",
        "acceptance_rate": 0.963949123785618
      },
      {
        "rank": 2,
        "method": "Tree V2 (D=4, B=2, t=0.03)",
        "acceptance_rate": 0.8742486429233416
      },
      {
        "rank": 3,
        "method": "Tree V2 (D=4, B=2, t=0.05)",
        "acceptance_rate": 0.8737018213238885
      },
      {
        "rank": 4,
        "method": "Linear K=5",
        "acceptance_rate": 0.8260349456896403
      },
      {
        "rank": 5,
        "method": "Streaming K=5 cache=1024",
        "acceptance_rate": 0.8260349456896403
      },
      {
        "rank": 6,
        "method": "Linear K=6",
        "acceptance_rate": 0.8243212760916794
      },
      {
        "rank": 7,
        "method": "Streaming K=6 cache=512",
        "acceptance_rate": 0.8243212760916794
      },
      {
        "rank": 8,
        "method": "Tree V2 (D=5, B=2, t=0.05)",
        "acceptance_rate": 0.7888351841509491
      },
      {
        "rank": 9,
        "method": "Linear K=7",
        "acceptance_rate": 0.7770710015172239
      },
      {
        "rank": 10,
        "method": "Tree V2 (D=6, B=2, t=0.05)",
        "acceptance_rate": 0.7057240674774234
      },
      {
        "rank": 11,
        "method": "Tree V2 (D=7, B=2, t=0.05)",
        "acceptance_rate": 0.6490049577819497
      }
    ]
  },
  "timestamp": "2026-01-03T16:18:08.354049"
}